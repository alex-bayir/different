#!/bin/bash
log=log.txt; help="
Usage:
sudo bash this.sh -h <host> -p <port>
sudo bash this.sh -s
sudo bash this.sh -h <host> -p <port> -s

Options:
  -h, --host     <host>  SIEM hostname
  -p, --port     <port>  SIEM port
  -s, --save             audit log file (/var/log/audit/audit.log)
  -l, --log      <file>  logging of changes to a file
                           (this script) (by default: $log)

 --help         display this help and exit"

while [ "$#" -gt 0 ]; do
    case $1 in
        -h|--host) host=$2; shift;;
        -p|--port) port=$2; shift;;
        -s|--save) journal=/var/log/audit/audit.log; shift;;
        -l|--log)  log=$2; shift;;
        --help) echo -e "$help"; exit 0;;
        *) echo "Unknown parameter passed: $1"; echo -e "$help"; exit 1 ;;
    esac
    shift
done

[ "$(whoami)" != root ] && { echo "ERROR: There are not enough privileges to execute."; exit 1; }
which service auditd auditctl rsyslogd tee base64 diff sed cat echo 1>/dev/null || { echo -e "ERROR: Some of the required packages are missing."; exit 1; }
([ $host ] && [ $port ]) || ([ ! $host ] && [ ! $port ] && [ $journal ]) || { echo "ERROR: Not correct params: need specify --host and --port or/and use --save"; }

# get os,auditd info
echo ">cat /etc/*release* /etc/*version* 2>/dev/null:" > $log
cat /etc/*release* /etc/*version* 2>/dev/null >> $log
echo ">auditctl -v && auditctl -s:" >> $log
auditctl -v >> $log && auditctl -s >> $log

# backup auditd rules
if [ ! -s audit.rules.bak ] && [ $(auditctl -l > audit.rules.bak) ]; then 
    echo "INFO: Current rules saved to audit.rules.bak";
fi

rules="IyBSZW1vdmUgYW55IGV4aXN0aW5nIHJ1bGVzCi1ECgojIEJ1ZmZlciBTaXplCiMjIEZlZWwgZnJlZSB0byBpbmNyZWFzZSB0aGlzIGlmIHRoZSBtYWNoaW5lIHBhbmljJ3MKLWIgODE5MgoKIyBGYWlsdXJlIE1vZGUKIyMgUG9zc2libGUgdmFsdWVzOiAwIChzaWxlbnQpLCAxIChwcmludGssIHByaW50IGEgZmFpbHVyZSBtZXNzYWdlKSwgMiAocGFuaWMsIGhhbHQgdGhlIHN5c3RlbSkKLWYgMQoKIyBJZ25vcmUgZXJyb3JzCiMjIGUuZy4gY2F1c2VkIGJ5IHVzZXJzIG9yIGZpbGVzIG5vdCBmb3VuZCBpbiB0aGUgbG9jYWwgZW52aXJvbm1lbnQKLWkKCiMgU2VsZiBBdWRpdGluZyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCiMjIEF1ZGl0IHRoZSBhdWRpdCBsb2dzCiMjIyBTdWNjZXNzZnVsIGFuZCB1bnN1Y2Nlc3NmdWwgYXR0ZW1wdHMgdG8gcmVhZCBpbmZvcm1hdGlvbiBmcm9tIHRoZSBhdWRpdCByZWNvcmRzCi13IC92YXIvbG9nL2F1ZGl0LyAtcCB3cmEgLWsgYXVkaXRsb2cKLXcgL3Zhci9hdWRpdC8gLXAgd3JhIC1rIGF1ZGl0bG9nCgojIyBBdWRpdGQgY29uZmlndXJhdGlvbgojIyMgTW9kaWZpY2F0aW9ucyB0byBhdWRpdCBjb25maWd1cmF0aW9uIHRoYXQgb2NjdXIgd2hpbGUgdGhlIGF1ZGl0IGNvbGxlY3Rpb24gZnVuY3Rpb25zIGFyZSBvcGVyYXRpbmcKLXcgL2V0Yy9hdWRpdC8gLXAgd2EgLWsgYXVkaXRjb25maWcKLXcgL2V0Yy9saWJhdWRpdC5jb25mIC1wIHdhIC1rIGF1ZGl0Y29uZmlnCi13IC9ldGMvYXVkaXNwLyAtcCB3YSAtayBhdWRpc3Bjb25maWcKCiMjIE1vbml0b3IgZm9yIHVzZSBvZiBhdWRpdCBtYW5hZ2VtZW50IHRvb2xzCi13IC9zYmluL2F1ZGl0Y3RsIC1wIHggLWsgYXVkaXR0b29scwotdyAvc2Jpbi9hdWRpdGQgLXAgeCAtayBhdWRpdHRvb2xzCi13IC91c3Ivc2Jpbi9hdWRpdGQgLXAgeCAtayBhdWRpdHRvb2xzCi13IC91c3Ivc2Jpbi9hdWdlbnJ1bGVzIC1wIHggLWsgYXVkaXR0b29scwoKIyMgQWNjZXNzIHRvIGFsbCBhdWRpdCB0cmFpbHMKCi1hIGFsd2F5cyxleGl0IC1GIHBhdGg9L3Vzci9zYmluL2F1c2VhcmNoIC1GIHBlcm09eCAtayBhdWRpdHRvb2xzCi1hIGFsd2F5cyxleGl0IC1GIHBhdGg9L3Vzci9zYmluL2F1cmVwb3J0IC1GIHBlcm09eCAtayBhdWRpdHRvb2xzCi1hIGFsd2F5cyxleGl0IC1GIHBhdGg9L3Vzci9zYmluL2F1bGFzdCAtRiBwZXJtPXggLWsgYXVkaXR0b29scwotYSBhbHdheXMsZXhpdCAtRiBwYXRoPS91c3Ivc2Jpbi9hdWxhc3Rsb2dpbiAtRiBwZXJtPXggLWsgYXVkaXR0b29scwotYSBhbHdheXMsZXhpdCAtRiBwYXRoPS91c3Ivc2Jpbi9hdXZpcnQgLUYgcGVybT14IC1rIGF1ZGl0dG9vbHMKCiMgRmlsdGVycyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCiMjIyBXZSBwdXQgdGhlc2UgZWFybHkgYmVjYXVzZSBhdWRpdCBpcyBhIGZpcnN0IG1hdGNoIHdpbnMgc3lzdGVtLgoKIyMjIE9VUiBGSUxURVJTCgojIyBJZ25vcmUgc3RhcnQgYW5kIHN0b3Agc2VydmljZSBmcm9tIHJvb3QKLWEgYWx3YXlzLGV4Y2x1ZGUgLUYgdWlkPXJvb3QgLUYgYXVpZD11bnNldCAtRiBtc2d0eXBlPVNFUlZJQ0VfU1RBUlQKLWEgYWx3YXlzLGV4Y2x1ZGUgLUYgdWlkPXJvb3QgLUYgYXVpZD11bnNldCAtRiBtc2d0eXBlPVNFUlZJQ0VfU1RPUAoKIyMgSWdub3JlIG1lc3NhZ2VzIGZyb20gYXBhY2hlIHNlcnZpY2UgZnJvbSByb290Ci1hIGFsd2F5cyxleGNsdWRlIC1GIGF1aWQ9YXBhY2hlIC1GIHVpZD1yb290Ci1hIGFsd2F5cyxleGNsdWRlIC1GIG1zZ3R5cGU9VVNFUl9BQ0NUIC1GIGF1aWQ9dW5zZXQgLUYgdWlkPXJvb3QKLWEgYWx3YXlzLGV4Y2x1ZGUgLUYgbXNndHlwZT1DUkVEX0FDUSAtRiBhdWlkPXVuc2V0IC1GIHVpZD1yb290CgojIyBJZ25vcmUgYXBhY2hlIHNlcnZpY2Ugc3lzY2FsbHMKLWEgbmV2ZXIsZXhpdCAtUyBhbGwgLUYgdWlkPWFwYWNoZQoKIyMgVGhpcyBwcmV2ZW50cyBjaHJvbnkgZnJvbSBvdmVyd2hlbG1pbmcgdGhlIGxvZ3MKLWEgbmV2ZXIsZXhpdCAtRiBhcmNoPWIzMiAtUyBhZGp0aW1leCAtRiBhdWlkPXVuc2V0IC1GIHVpZD1jaHJvbnkKLWEgbmV2ZXIsZXhpdCAtRiBhcmNoPWI2NCAtUyBhZGp0aW1leCAtRiBhdWlkPXVuc2V0IC1GIHVpZD1jaHJvbnkKLWEgYWx3YXlzLGV4Y2x1ZGUgLUYgbXNndHlwZT1USU1FX0FESk5UUFZBTAotYSBuZXZlcixleGl0IC1GIGFyY2g9YjMyIC1TIGNvbm5lY3QgLUYgc3VjY2Vzcz0xIC1GIGF1aWQ9dW5zZXQgLUYgdWlkPWNocm9ueQotYSBuZXZlcixleGl0IC1GIGFyY2g9YjY0IC1TIGNvbm5lY3QgLUYgc3VjY2Vzcz0xIC1GIGF1aWQ9dW5zZXQgLUYgdWlkPWNocm9ueQotYSBuZXZlcixleGl0IC1GIGFyY2g9YjMyIC1TIHNvY2tldCAgLUYgc3VjY2Vzcz0xIC1GIGF1aWQ9dW5zZXQgLUYgdWlkPWNocm9ueQotYSBuZXZlcixleGl0IC1GIGFyY2g9YjY0IC1TIHNvY2tldCAgLUYgc3VjY2Vzcz0xIC1GIGF1aWQ9dW5zZXQgLUYgdWlkPWNocm9ueQoKIyMgSWdub3JlIFN1Y2Nlc3NmdWwgQ29ubmVjdGlvbnMgZm9yIGphdmEgYW5kIHB5dGhvbgotYSBuZXZlcixleGl0IC1GIHVpZD1jb25mbHVlbmNlIC1GIGF1aWQ9cm9vdCAtRiBhcmNoPWIzMiAtUyBjb25uZWN0IC1GIHN1Y2Nlc3M9MSAtRiBleGU9L29wdC9hdGxhc3NpYW4vY29uZmx1ZW5jZS9qcmUvYmluL2phdmEKLWEgbmV2ZXIsZXhpdCAtRiB1aWQ9Y29uZmx1ZW5jZSAtRiBhdWlkPXJvb3QgLUYgYXJjaD1iNjQgLVMgY29ubmVjdCAtRiBzdWNjZXNzPTEgLUYgZXhlPS9vcHQvYXRsYXNzaWFuL2NvbmZsdWVuY2UvanJlL2Jpbi9qYXZhCi1hIG5ldmVyLGV4aXQgLUYgdWlkPWNvbmZsdWVuY2UgLUYgYXVpZD1yb290IC1GIGFyY2g9YjMyIC1TIHNvY2tldCAgLUYgc3VjY2Vzcz0xIC1GIGV4ZT0vb3B0L2F0bGFzc2lhbi9jb25mbHVlbmNlL2pyZS9iaW4vamF2YQotYSBuZXZlcixleGl0IC1GIHVpZD1jb25mbHVlbmNlIC1GIGF1aWQ9cm9vdCAtRiBhcmNoPWI2NCAtUyBzb2NrZXQgIC1GIHN1Y2Nlc3M9MSAtRiBleGU9L29wdC9hdGxhc3NpYW4vY29uZmx1ZW5jZS9qcmUvYmluL2phdmEKLWEgbmV2ZXIsZXhpdCAtRiB1aWQ9cm9vdCAtRiBhdWlkPXVuc2V0IC1GIGFyY2g9YjMyIC1TIGNvbm5lY3QgLUYgc3VjY2Vzcz0xIC1GIGV4ZT0vdXNyL2xpYmV4ZWMvcGxhdGZvcm0tcHl0aG9uMy42Ci1hIG5ldmVyLGV4aXQgLUYgdWlkPXJvb3QgLUYgYXVpZD11bnNldCAtRiBhcmNoPWI2NCAtUyBjb25uZWN0IC1GIHN1Y2Nlc3M9MSAtRiBleGU9L3Vzci9saWJleGVjL3BsYXRmb3JtLXB5dGhvbjMuNgotYSBuZXZlcixleGl0IC1GIHVpZD1yb290IC1GIGF1aWQ9dW5zZXQgLUYgYXJjaD1iMzIgLVMgc29ja2V0ICAtRiBzdWNjZXNzPTEgLUYgZXhlPS91c3IvbGliZXhlYy9wbGF0Zm9ybS1weXRob24zLjYKLWEgbmV2ZXIsZXhpdCAtRiB1aWQ9cm9vdCAtRiBhdWlkPXVuc2V0IC1GIGFyY2g9YjY0IC1TIHNvY2tldCAgLUYgc3VjY2Vzcz0xIC1GIGV4ZT0vdXNyL2xpYmV4ZWMvcGxhdGZvcm0tcHl0aG9uMy42CgojIyBJZ25vcmUgc3RhbmRhcnQgYWN0aXZpdHkKLWEgbmV2ZXIsZXhpdCAtRiBhdWlkPXVuc2V0IC1GIHVpZD1yb290IC1GIHBhdGg9L2V0Yy9zaGFkb3cgLUYgcGVybT1yIC1GIHN1Y2Nlc3M9MSAtRiBleGU9L3Vzci9saWIvc3lzdGVtZC9zeXN0ZW1kCi1hIG5ldmVyLGV4aXQgLUYgYXVpZD11bnNldCAtRiB1aWQ9cm9vdCAtRiBwYXRoPS9ldGMvc2hhZG93IC1GIHBlcm09ciAtRiBzdWNjZXNzPTEgLUYgZXhlPS91c3Ivc2Jpbi9jcm9uZAotYSBuZXZlcixleGl0IC1GIGF1aWQ9dW5zZXQgLUYgdWlkPXJvb3QgLUYgZGlyPS9ydW4vc3lzdGVtZC9zZXNzaW9ucy8gLUYgcGVybT1yIC1GIHN1Y2Nlc3M9MSAtRiBleGU9L3Vzci9zYmluL2Nyb25kCi1hIG5ldmVyLGV4aXQgLUYgYXJjaD1iMzIgLVMgbWtub2QgLUYgc3VjY2Vzcz0xIC1GIGF1aWQ9dW5zZXQgLUYgdWlkPXJvb3QgLUYgZGlyPS9ydW4vc3lzdGVtZC9zZXNzaW9ucy8gLUYgZXhlPS91c3IvbGliL3N5c3RlbWQvc3lzdGVtZC1sb2dpbmQKLWEgbmV2ZXIsZXhpdCAtRiBhcmNoPWI2NCAtUyBta25vZCAtRiBzdWNjZXNzPTEgLUYgYXVpZD11bnNldCAtRiB1aWQ9cm9vdCAtRiBkaXI9L3J1bi9zeXN0ZW1kL3Nlc3Npb25zLyAtRiBleGU9L3Vzci9saWIvc3lzdGVtZC9zeXN0ZW1kLWxvZ2luZAoKIyMgSWdub3JlIG5naW54IHNvY2tldHMKLWEgbmV2ZXIsZXhpdCAtRiB1aWQ9bmdpbnggLUYgYXVpZD11bnNldCAtRiBhcmNoPWIzMiAtUyBzb2NrZXQgIC1GIHN1Y2Nlc3M9MQotYSBuZXZlcixleGl0IC1GIHVpZD1uZ2lueCAtRiBhdWlkPXVuc2V0IC1GIGFyY2g9YjY0IC1TIHNvY2tldCAgLUYgc3VjY2Vzcz0xCgojIyBJZ25vcmUgYmFzaCBjb21tYW5kcyBmb3IgY29uZmx1ZW5jZQotYSBuZXZlcixleGl0IC1GIGV4ZT0vYmluL2Jhc2ggLXAgeCAtRiB1aWQ9Y29uZmx1ZW5jZSAtRiBhdWlkPXJvb3QKCiMjIyBEZWZhdWx0IEZJTFRFUlMKCiMjIElnbm9yZSBTRUxpbnV4IEFWQyByZWNvcmRzCi1hIGFsd2F5cyxleGNsdWRlIC1GIG1zZ3R5cGU9QVZDCgojIyBJZ25vcmUgY3VycmVudCB3b3JraW5nIGRpcmVjdG9yeSByZWNvcmRzCi1hIGFsd2F5cyxleGNsdWRlIC1GIG1zZ3R5cGU9Q1dECgojIyBDcm9uIGpvYnMgZmlsbCB0aGUgbG9ncyB3aXRoIHN0dWZmIHdlIG5vcm1hbGx5IGRvbid0IHdhbnQgKHdvcmtzIHdpdGggU0VMaW51eCkKLWEgbmV2ZXIsdXNlciAtRiBzdWJqX3R5cGU9Y3JvbmRfdAotYSBuZXZlcixleGl0IC1GIHN1YmpfdHlwZT1jcm9uZF90CgojIyBUaGlzIHByZXZlbnRzIGNocm9ueSBmcm9tIG92ZXJ3aGVsbWluZyB0aGUgbG9ncwotYSBuZXZlcixleGl0IC1GIGFyY2g9YjY0IC1TIGFkanRpbWV4IC1GIGF1aWQ9LTEgLUYgdWlkPWNocm9ueSAtRiBzdWJqX3R5cGU9Y2hyb255ZF90CgojIyBUaGlzIGlzIG5vdCB2ZXJ5IGludGVyZXN0aW5nIGFuZCB3YXN0ZXMgYSBsb3Qgb2Ygc3BhY2UgaWYgdGhlIHNlcnZlciBpcyBwdWJsaWMgZmFjaW5nCi1hIGFsd2F5cyxleGNsdWRlIC1GIG1zZ3R5cGU9Q1JZUFRPX0tFWV9VU0VSCgojIyBPcGVuIFZNIFRvb2xzCi1hIGV4aXQsbmV2ZXIgLUYgYXJjaD1iNjQgLVMgYWxsIC1GIGV4ZT0vdXNyL2Jpbi92bXRvb2xzZAoKIyMgSGlnaCBWb2x1bWUgRXZlbnQgRmlsdGVyIChlc3BlY2lhbGx5IG9uIExpbnV4IFdvcmtzdGF0aW9ucykKLWEgbmV2ZXIsZXhpdCAtRiBhcmNoPWI2NCAtRiBkaXI9L2Rldi9zaG0gLWsgc2hhcmVkbWVtYWNjZXNzCi1hIG5ldmVyLGV4aXQgLUYgYXJjaD1iNjQgLUYgZGlyPS92YXIvbG9jay9sdm0gLWsgbG9ja2x2bQoKIyMgRmlsZUJlYXQKLWEgbmV2ZXIsZXhpdCAtRiBhcmNoPWI2NCAtRiBwYXRoPS9vcHQvZmlsZWJlYXQgLWsgZmlsZWJlYXQKCiMjIE1vcmUgaW5mb3JtYXRpb24gb24gaG93IHRvIGZpbHRlciBldmVudHMKIyMjIGh0dHBzOi8vYWNjZXNzLnJlZGhhdC5jb20vc29sdXRpb25zLzI0ODIyMjEKCiMgUnVsZXMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCiMjIEtlcm5lbCBwYXJhbWV0ZXJzCi13IC9ldGMvc3lzY3RsLmNvbmYgLXAgd2EgLWsgc3lzY3RsCi13IC9ldGMvc3lzY3RsLmQgLXAgd2EgLWsgc3lzY3RsCgojIyBLZXJuZWwgbW9kdWxlIGxvYWRpbmcgYW5kIHVubG9hZGluZwotYSBhbHdheXMsZXhpdCAtRiBwZXJtPXggLUYgYXVpZCE9LTEgLUYgcGF0aD0vc2Jpbi9pbnNtb2QgLWsgbW9kdWxlcwotYSBhbHdheXMsZXhpdCAtRiBwZXJtPXggLUYgYXVpZCE9LTEgLUYgcGF0aD0vc2Jpbi9tb2Rwcm9iZSAtayBtb2R1bGVzCi1hIGFsd2F5cyxleGl0IC1GIHBlcm09eCAtRiBhdWlkIT0tMSAtRiBwYXRoPS9zYmluL3JtbW9kIC1rIG1vZHVsZXMKLWEgYWx3YXlzLGV4aXQgLUYgYXJjaD1iNjQgLVMgZmluaXRfbW9kdWxlIC1TIGluaXRfbW9kdWxlIC1TIGRlbGV0ZV9tb2R1bGUgLUYgYXVpZCE9LTEgLWsgbW9kdWxlcwoKIyMgTW9kcHJvYmUgY29uZmlndXJhdGlvbgotdyAvZXRjL21vZHByb2JlLmNvbmYgLXAgd2EgLWsgbW9kcHJvYmUKLXcgL2V0Yy9tb2Rwcm9iZS5kIC1wIHdhIC1rIG1vZHByb2JlCgojIyBLRXhlYyB1c2FnZSAoYWxsIGFjdGlvbnMpCi1hIGFsd2F5cyxleGl0IC1GIGFyY2g9YjY0IC1TIGtleGVjX2xvYWQgLWsgS0VYRUMKCiMjIFNwZWNpYWwgZmlsZXMKLWEgYWx3YXlzLGV4aXQgLUYgYXJjaD1iNjQgLVMgbWtub2QgLVMgbWtub2RhdCAtayBzcGVjaWFsZmlsZXMKCiMjIE1vdW50IG9wZXJhdGlvbnMgKG9ubHkgYXR0cmlidXRhYmxlKQotYSBhbHdheXMsZXhpdCAtRiBhcmNoPWI2NCAtUyBtb3VudCAtUyB1bW91bnQyIC1GIGF1aWQhPS0xIC1rIG1vdW50CgojIyMgTkZTIG1vdW50Ci1hIGFsd2F5cyxleGl0IC1GIHBhdGg9L3NiaW4vbW91bnQubmZzIC1GIHBlcm09eCAtRiBhdWlkPj01MDAgLUYgYXVpZCE9NDI5NDk2NzI5NSAtayBUMTA3OF9WYWxpZF9BY2NvdW50cwotYSBhbHdheXMsZXhpdCAtRiBwYXRoPS91c3Ivc2Jpbi9tb3VudC5uZnMgLUYgcGVybT14IC1GIGF1aWQ+PTUwMCAtRiBhdWlkIT00Mjk0OTY3Mjk1IC1rIFQxMDc4X1ZhbGlkX0FjY291bnRzCgojIyBDaGFuZ2Ugc3dhcCAob25seSBhdHRyaWJ1dGFibGUpCi1hIGFsd2F5cyxleGl0IC1GIGFyY2g9YjY0IC1TIHN3YXBvbiAtUyBzd2Fwb2ZmIC1GIGF1aWQhPS0xIC1rIHN3YXAKCiMjIFRpbWUKLWEgYWx3YXlzLGV4aXQgLUYgYXJjaD1iNjQgLVMgYWRqdGltZXggLVMgc2V0dGltZW9mZGF5IC1TIGNsb2NrX3NldHRpbWUgLWsgdGltZQojIyMgTG9jYWwgdGltZSB6b25lCi13IC9ldGMvbG9jYWx0aW1lIC1wIHdhIC1rIGxvY2FsdGltZQoKIyMgU3R1bm5lbAotdyAvdXNyL3NiaW4vc3R1bm5lbCAtcCB4IC1rIHN0dW5uZWwKLXcgL3Vzci9iaW4vc3R1bm5lbCAtcCB4IC1rIHN0dW5uZWwKCiMjIENyb24gY29uZmlndXJhdGlvbiAmIHNjaGVkdWxlZCBqb2JzCi13IC9ldGMvY3Jvbi5hbGxvdyAtcCB3YSAtayBjcm9uCi13IC9ldGMvY3Jvbi5kZW55IC1wIHdhIC1rIGNyb24KLXcgL2V0Yy9jcm9uLmQvIC1wIHdhIC1rIGNyb24KLXcgL2V0Yy9jcm9uLmRhaWx5LyAtcCB3YSAtayBjcm9uCi13IC9ldGMvY3Jvbi5ob3VybHkvIC1wIHdhIC1rIGNyb24KLXcgL2V0Yy9jcm9uLm1vbnRobHkvIC1wIHdhIC1rIGNyb24KLXcgL2V0Yy9jcm9uLndlZWtseS8gLXAgd2EgLWsgY3JvbgotdyAvZXRjL2Nyb250YWIgLXAgd2EgLWsgY3JvbgotdyAvdmFyL3Nwb29sL2Nyb24vIC1wIHdhIC1rIGNyb24KCiMjIFVzZXIsIGdyb3VwLCBwYXNzd29yZCBkYXRhYmFzZXMKLXcgL2V0Yy9ncm91cCAtcCB3YSAtayBldGNncm91cAotdyAvZXRjL3Bhc3N3ZCAtcCB3YSAtayBldGNwYXNzd2QKLXcgL2V0Yy9nc2hhZG93IC1rIGV0Y2dyb3VwCi13IC9ldGMvc2hhZG93IC1rIGV0Y3Bhc3N3ZAotdyAvZXRjL3NlY3VyaXR5L29wYXNzd2QgLWsgb3Bhc3N3ZAoKIyMgU3Vkb2VycyBmaWxlIGNoYW5nZXMKLXcgL2V0Yy9zdWRvZXJzIC1wIHdhIC1rIGFjdGlvbnMKLXcgL2V0Yy9zdWRvZXJzLmQvIC1wIHdhIC1rIGFjdGlvbnMKCiMjIFBhc3N3ZAotdyAvdXNyL2Jpbi9wYXNzd2QgLXAgeCAtayBwYXNzd2RfbW9kaWZpY2F0aW9uCgojIyBUb29scyB0byBjaGFuZ2UgZ3JvdXAgaWRlbnRpZmllcnMKLXcgL3Vzci9zYmluL2dyb3VwYWRkIC1wIHggLWsgZ3JvdXBfbW9kaWZpY2F0aW9uCi13IC91c3Ivc2Jpbi9ncm91cG1vZCAtcCB4IC1rIGdyb3VwX21vZGlmaWNhdGlvbgotdyAvdXNyL3NiaW4vYWRkZ3JvdXAgLXAgeCAtayBncm91cF9tb2RpZmljYXRpb24KLXcgL3Vzci9zYmluL3VzZXJhZGQgLXAgeCAtayB1c2VyX21vZGlmaWNhdGlvbgotdyAvdXNyL3NiaW4vdXNlcmRlbCAtcCB4IC1rIHVzZXJfbW9kaWZpY2F0aW9uCi13IC91c3Ivc2Jpbi91c2VybW9kIC1wIHggLWsgdXNlcl9tb2RpZmljYXRpb24KLXcgL3Vzci9zYmluL2FkZHVzZXIgLXAgeCAtayB1c2VyX21vZGlmaWNhdGlvbgoKIyMgTG9naW4gY29uZmlndXJhdGlvbiBhbmQgaW5mb3JtYXRpb24KLXcgL2V0Yy9sb2dpbi5kZWZzIC1wIHdhIC1rIGxvZ2luCi13IC9ldGMvc2VjdXJldHR5IC1wIHdhIC1rIGxvZ2luCi13IC92YXIvbG9nL2ZhaWxsb2cgLXAgd2EgLWsgbG9naW4KLXcgL3Zhci9sb2cvbGFzdGxvZyAtcCB3YSAtayBsb2dpbgotdyAvdmFyL2xvZy90YWxseWxvZyAtcCB3YSAtayBsb2dpbgoKIyMgTmV0d29yayBFbnZpcm9ubWVudAojIyMgQ2hhbmdlcyB0byBob3N0bmFtZQotYSBhbHdheXMsZXhpdCAtRiBhcmNoPWI2NCAtUyBzZXRob3N0bmFtZSAtUyBzZXRkb21haW5uYW1lIC1rIG5ldHdvcmtfbW9kaWZpY2F0aW9ucwoKIyMjIERldGVjdCBSZW1vdGUgU2hlbGwgVXNlCi1hIGFsd2F5cyxleGl0IC1GIGFyY2g9YjY0IC1GIGV4ZT0vYmluL2Jhc2ggLUYgc3VjY2Vzcz0xIC1TIGNvbm5lY3QgLWsgInJlbW90ZV9zaGVsbCIKLWEgYWx3YXlzLGV4aXQgLUYgYXJjaD1iNjQgLUYgZXhlPS91c3IvYmluL2Jhc2ggLUYgc3VjY2Vzcz0xIC1TIGNvbm5lY3QgLWsgInJlbW90ZV9zaGVsbCIKCiMjIyBTdWNjZXNzZnVsIElQdjQgQ29ubmVjdGlvbnMKLWEgYWx3YXlzLGV4aXQgLUYgYXJjaD1iNjQgLVMgY29ubmVjdCAtRiBhMj0xNiAtRiBzdWNjZXNzPTEgLUYga2V5PW5ldHdvcmtfY29ubmVjdF80CgojIyMgU3VjY2Vzc2Z1bCBJUHY2IENvbm5lY3Rpb25zCi1hIGFsd2F5cyxleGl0IC1GIGFyY2g9YjY0IC1TIGNvbm5lY3QgLUYgYTI9MjggLUYgc3VjY2Vzcz0xIC1GIGtleT1uZXR3b3JrX2Nvbm5lY3RfNgoKIyMjIENoYW5nZXMgdG8gb3RoZXIgZmlsZXMKLXcgL2V0Yy9ob3N0cyAtcCB3YSAtayBuZXR3b3JrX21vZGlmaWNhdGlvbnMKLXcgL2V0Yy9zeXNjb25maWcvbmV0d29yayAtcCB3YSAtayBuZXR3b3JrX21vZGlmaWNhdGlvbnMKLXcgL2V0Yy9zeXNjb25maWcvbmV0d29yay1zY3JpcHRzIC1wIHcgLWsgbmV0d29ya19tb2RpZmljYXRpb25zCi13IC9ldGMvbmV0d29yay8gLXAgd2EgLWsgbmV0d29yawotYSBhbHdheXMsZXhpdCAtRiBkaXI9L2V0Yy9OZXR3b3JrTWFuYWdlci8gLUYgcGVybT13YSAtayBuZXR3b3JrX21vZGlmaWNhdGlvbnMKCiMjIyBDaGFuZ2VzIHRvIGlzc3VlCi13IC9ldGMvaXNzdWUgLXAgd2EgLWsgZXRjaXNzdWUKLXcgL2V0Yy9pc3N1ZS5uZXQgLXAgd2EgLWsgZXRjaXNzdWUKCiMjIFN5c3RlbSBzdGFydHVwIHNjcmlwdHMKLXcgL2V0Yy9pbml0dGFiIC1wIHdhIC1rIGluaXQKLXcgL2V0Yy9pbml0LmQvIC1wIHdhIC1rIGluaXQKLXcgL2V0Yy9pbml0LyAtcCB3YSAtayBpbml0CgojIyBMaWJyYXJ5IHNlYXJjaCBwYXRocwotdyAvZXRjL2xkLnNvLmNvbmYgLXAgd2EgLWsgbGlicGF0aAotdyAvZXRjL2xkLnNvLmNvbmYuZCAtcCB3YSAtayBsaWJwYXRoCgojIyBTeXN0ZW13aWRlIGxpYnJhcnkgcHJlbG9hZHMgKExEX1BSRUxPQUQpCi13IC9ldGMvbGQuc28ucHJlbG9hZCAtcCB3YSAtayBzeXN0ZW13aWRlX3ByZWxvYWRzCgojIyBQYW0gY29uZmlndXJhdGlvbgotdyAvZXRjL3BhbS5kLyAtcCB3YSAtayBwYW0KLXcgL2V0Yy9zZWN1cml0eS9saW1pdHMuY29uZiAtcCB3YSAgLWsgcGFtCi13IC9ldGMvc2VjdXJpdHkvbGltaXRzLmQgLXAgd2EgIC1rIHBhbQotdyAvZXRjL3NlY3VyaXR5L3BhbV9lbnYuY29uZiAtcCB3YSAtayBwYW0KLXcgL2V0Yy9zZWN1cml0eS9uYW1lc3BhY2UuY29uZiAtcCB3YSAtayBwYW0KLXcgL2V0Yy9zZWN1cml0eS9uYW1lc3BhY2UuZCAtcCB3YSAtayBwYW0KLXcgL2V0Yy9zZWN1cml0eS9uYW1lc3BhY2UuaW5pdCAtcCB3YSAtayBwYW0KCiMjIE1haWwgY29uZmlndXJhdGlvbgotdyAvZXRjL2FsaWFzZXMgLXAgd2EgLWsgbWFpbAotdyAvZXRjL3Bvc3RmaXgvIC1wIHdhIC1rIG1haWwKLXcgL2V0Yy9leGltNC8gLXAgd2EgLWsgbWFpbAoKIyMgU1NIIGNvbmZpZ3VyYXRpb24KLXcgL2V0Yy9zc2gvc3NoZF9jb25maWcgLWsgc3NoZAotdyAvZXRjL3NzaC9zc2hkX2NvbmZpZy5kIC1rIHNzaGQKCiMjIHJvb3Qgc3NoIGtleSB0YW1wZXJpbmcKLXcgL3Jvb3QvLnNzaCAtcCB3YSAtayByb290a2V5CgojIFN5c3RlbWQKLXcgL2Jpbi9zeXN0ZW1jdGwgLXAgeCAtayBzeXN0ZW1kCi13IC9ldGMvc3lzdGVtZC8gLXAgd2EgLWsgc3lzdGVtZAotdyAvdXNyL2xpYi9zeXN0ZW1kIC1wIHdhIC1rIHN5c3RlbWQKCiMjIGh0dHBzOi8vc3lzdGVtZC5uZXR3b3JrL3N5c3RlbWQuZ2VuZXJhdG9yLmh0bWwKLXcgL2V0Yy9zeXN0ZW1kL3N5c3RlbS1nZW5lcmF0b3JzLyAtcCB3YSAtayBzeXN0ZW1kX2dlbmVyYXRvcgotdyAvdXNyL2xvY2FsL2xpYi9zeXN0ZW1kL3N5c3RlbS1nZW5lcmF0b3JzLyAtcCB3YSAtayBzeXN0ZW1kX2dlbmVyYXRvcgotdyAvdXNyL2xpYi9zeXN0ZW1kL3N5c3RlbS1nZW5lcmF0b3JzIC1wIHdhIC1rIHN5c3RlbWRfZ2VuZXJhdG9yCgotdyAvZXRjL3N5c3RlbWQvdXNlci1nZW5lcmF0b3JzLyAtcCB3YSAtayBzeXN0ZW1kX2dlbmVyYXRvcgotdyAvdXNyL2xvY2FsL2xpYi9zeXN0ZW1kL3VzZXItZ2VuZXJhdG9ycy8gLXAgd2EgLWsgc3lzdGVtZF9nZW5lcmF0b3IKLXcgL2xpYi9zeXN0ZW1kL3N5c3RlbS1nZW5lcmF0b3JzLyAtcCB3YSAtayBzeXN0ZW1kX2dlbmVyYXRvcgoKIyMgU0VMaW51eCBldmVudHMgdGhhdCBtb2RpZnkgdGhlIHN5c3RlbSdzIE1hbmRhdG9yeSBBY2Nlc3MgQ29udHJvbHMgKE1BQykKLXcgL2V0Yy9zZWxpbnV4LyAtcCB3YSAtayBtYWNfcG9saWN5CgojIyBDcml0aWNhbCBlbGVtZW50cyBhY2Nlc3MgZmFpbHVyZXMKLWEgYWx3YXlzLGV4aXQgLUYgYXJjaD1iNjQgLVMgb3BlbiAtRiBkaXI9L2V0YyAtRiBzdWNjZXNzPTAgLWsgdW5hdXRoZWRmaWxlYWNjZXNzCi1hIGFsd2F5cyxleGl0IC1GIGFyY2g9YjY0IC1TIG9wZW4gLUYgZGlyPS9iaW4gLUYgc3VjY2Vzcz0wIC1rIHVuYXV0aGVkZmlsZWFjY2VzcwotYSBhbHdheXMsZXhpdCAtRiBhcmNoPWI2NCAtUyBvcGVuIC1GIGRpcj0vc2JpbiAtRiBzdWNjZXNzPTAgLWsgdW5hdXRoZWRmaWxlYWNjZXNzCi1hIGFsd2F5cyxleGl0IC1GIGFyY2g9YjY0IC1TIG9wZW4gLUYgZGlyPS91c3IvYmluIC1GIHN1Y2Nlc3M9MCAtayB1bmF1dGhlZGZpbGVhY2Nlc3MKLWEgYWx3YXlzLGV4aXQgLUYgYXJjaD1iNjQgLVMgb3BlbiAtRiBkaXI9L3Vzci9zYmluIC1GIHN1Y2Nlc3M9MCAtayB1bmF1dGhlZGZpbGVhY2Nlc3MKLWEgYWx3YXlzLGV4aXQgLUYgYXJjaD1iNjQgLVMgb3BlbiAtRiBkaXI9L3ZhciAtRiBzdWNjZXNzPTAgLWsgdW5hdXRoZWRmaWxlYWNjZXNzCi1hIGFsd2F5cyxleGl0IC1GIGFyY2g9YjY0IC1TIG9wZW4gLUYgZGlyPS9ob21lIC1GIHN1Y2Nlc3M9MCAtayB1bmF1dGhlZGZpbGVhY2Nlc3MKLWEgYWx3YXlzLGV4aXQgLUYgYXJjaD1iNjQgLVMgb3BlbiAtRiBkaXI9L3NydiAtRiBzdWNjZXNzPTAgLWsgdW5hdXRoZWRmaWxlYWNjZXNzCgojIyBQcm9jZXNzIElEIGNoYW5nZSAoc3dpdGNoaW5nIGFjY291bnRzKSBhcHBsaWNhdGlvbnMKLXcgL2Jpbi9zdSAtcCB4IC1rIHByaXZfZXNjCi13IC91c3IvYmluL3N1ZG8gLXAgeCAtayBwcml2X2VzYwoKIyMgUG93ZXIgc3RhdGUKLXcgL3NiaW4vc2h1dGRvd24gLXAgeCAtayBwb3dlcgotdyAvc2Jpbi9wb3dlcm9mZiAtcCB4IC1rIHBvd2VyCi13IC9zYmluL3JlYm9vdCAtcCB4IC1rIHBvd2VyCi13IC9zYmluL2hhbHQgLXAgeCAtayBwb3dlcgoKIyMgU2Vzc2lvbiBpbml0aWF0aW9uIGluZm9ybWF0aW9uCi13IC92YXIvcnVuL3V0bXAgLXAgd2EgLWsgc2Vzc2lvbgotdyAvdmFyL2xvZy9idG1wIC1wIHdhIC1rIHNlc3Npb24KLXcgL3Zhci9sb2cvd3RtcCAtcCB3YSAtayBzZXNzaW9uCgojIyBEaXNjcmV0aW9uYXJ5IEFjY2VzcyBDb250cm9sIChEQUMpIG1vZGlmaWNhdGlvbnMKLWEgYWx3YXlzLGV4aXQgLUYgYXJjaD1iNjQgLVMgY2htb2QgIC1GIGF1aWQ+PTEwMDAgLUYgYXVpZCE9LTEgLWsgcGVybV9tb2QKLWEgYWx3YXlzLGV4aXQgLUYgYXJjaD1iNjQgLVMgY2hvd24gLUYgYXVpZD49MTAwMCAtRiBhdWlkIT0tMSAtayBwZXJtX21vZAotYSBhbHdheXMsZXhpdCAtRiBhcmNoPWI2NCAtUyBmY2htb2QgLUYgYXVpZD49MTAwMCAtRiBhdWlkIT0tMSAtayBwZXJtX21vZAotYSBhbHdheXMsZXhpdCAtRiBhcmNoPWI2NCAtUyBmY2htb2RhdCAtRiBhdWlkPj0xMDAwIC1GIGF1aWQhPS0xIC1rIHBlcm1fbW9kCi1hIGFsd2F5cyxleGl0IC1GIGFyY2g9YjY0IC1TIGZjaG93biAtRiBhdWlkPj0xMDAwIC1GIGF1aWQhPS0xIC1rIHBlcm1fbW9kCi1hIGFsd2F5cyxleGl0IC1GIGFyY2g9YjY0IC1TIGZjaG93bmF0IC1GIGF1aWQ+PTEwMDAgLUYgYXVpZCE9LTEgLWsgcGVybV9tb2QKLWEgYWx3YXlzLGV4aXQgLUYgYXJjaD1iNjQgLVMgZnJlbW92ZXhhdHRyIC1GIGF1aWQ+PTEwMDAgLUYgYXVpZCE9LTEgLWsgcGVybV9tb2QKLWEgYWx3YXlzLGV4aXQgLUYgYXJjaD1iNjQgLVMgZnNldHhhdHRyIC1GIGF1aWQ+PTEwMDAgLUYgYXVpZCE9LTEgLWsgcGVybV9tb2QKLWEgYWx3YXlzLGV4aXQgLUYgYXJjaD1iNjQgLVMgbGNob3duIC1GIGF1aWQ+PTEwMDAgLUYgYXVpZCE9LTEgLWsgcGVybV9tb2QKLWEgYWx3YXlzLGV4aXQgLUYgYXJjaD1iNjQgLVMgbHJlbW92ZXhhdHRyIC1GIGF1aWQ+PTEwMDAgLUYgYXVpZCE9LTEgLWsgcGVybV9tb2QKLWEgYWx3YXlzLGV4aXQgLUYgYXJjaD1iNjQgLVMgbHNldHhhdHRyIC1GIGF1aWQ+PTEwMDAgLUYgYXVpZCE9LTEgLWsgcGVybV9tb2QKLWEgYWx3YXlzLGV4aXQgLUYgYXJjaD1iNjQgLVMgcmVtb3ZleGF0dHIgLUYgYXVpZD49MTAwMCAtRiBhdWlkIT0tMSAtayBwZXJtX21vZAotYSBhbHdheXMsZXhpdCAtRiBhcmNoPWI2NCAtUyBzZXR4YXR0ciAtRiBhdWlkPj0xMDAwIC1GIGF1aWQhPS0xIC1rIHBlcm1fbW9kCgojIFNwZWNpYWwgUnVsZXMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgojIyBSZWNvbm5haXNzYW5jZQotdyAvdXNyL2Jpbi93aG9hbWkgLXAgeCAtayByZWNvbgotdyAvdXNyL2Jpbi9pZCAtcCB4IC1rIHJlY29uCi13IC9iaW4vaG9zdG5hbWUgLXAgeCAtayByZWNvbgotdyAvYmluL3VuYW1lIC1wIHggLWsgcmVjb24KLXcgL2V0Yy9pc3N1ZSAtcCByIC1rIHJlY29uCi13IC9ldGMvaG9zdG5hbWUgLXAgciAtayByZWNvbgoKIyMgU3VzcGljaW91cyBhY3Rpdml0eQotdyAvdXNyL2Jpbi93Z2V0IC1wIHggLWsgc3VzcF9hY3Rpdml0eQotdyAvdXNyL2Jpbi9jdXJsIC1wIHggLWsgc3VzcF9hY3Rpdml0eQotdyAvdXNyL2Jpbi9iYXNlNjQgLXAgeCAtayBzdXNwX2FjdGl2aXR5Ci13IC9iaW4vbmMgLXAgeCAtayBzdXNwX2FjdGl2aXR5Ci13IC9iaW4vbmV0Y2F0IC1wIHggLWsgc3VzcF9hY3Rpdml0eQotdyAvdXNyL2Jpbi9uY2F0IC1wIHggLWsgc3VzcF9hY3Rpdml0eQotdyAvdXNyL2Jpbi9zcyAtcCB4IC1rIHN1c3BfYWN0aXZpdHkKLXcgL3Vzci9iaW4vbmV0c3RhdCAtcCB4IC1rIHN1c3BfYWN0aXZpdHkKLXcgL3Vzci9iaW4vc3NoIC1wIHggLWsgc3VzcF9hY3Rpdml0eQotdyAvdXNyL2Jpbi9zY3AgLXAgeCAtayBzdXNwX2FjdGl2aXR5Ci13IC91c3IvYmluL3NmdHAgLXAgeCAtayBzdXNwX2FjdGl2aXR5Ci13IC91c3IvYmluL2Z0cCAtcCB4IC1rIHN1c3BfYWN0aXZpdHkKLXcgL3Vzci9iaW4vc29jYXQgLXAgeCAtayBzdXNwX2FjdGl2aXR5Ci13IC91c3IvYmluL3dpcmVzaGFyayAtcCB4IC1rIHN1c3BfYWN0aXZpdHkKLXcgL3Vzci9iaW4vdHNoYXJrIC1wIHggLWsgc3VzcF9hY3Rpdml0eQotdyAvdXNyL2Jpbi9yYXdzaGFyayAtcCB4IC1rIHN1c3BfYWN0aXZpdHkKLXcgL3Vzci9iaW4vcmRlc2t0b3AgLXAgeCAtayBzdXNwX2FjdGl2aXR5Ci13IC91c3IvbG9jYWwvYmluL3JkZXNrdG9wIC1wIHggLWsgc3VzcF9hY3Rpdml0eQotdyAvdXNyL2Jpbi93bGZyZWVyZHAgLXAgeCAtayBzdXNwX2FjdGl2aXR5Ci13IC91c3IvYmluL3hmcmVlcmRwIC1wIHggLWsgc3VzcF9hY3Rpdml0eQotdyAvdXNyL2xvY2FsL2Jpbi94ZnJlZXJkcCAtcCB4IC1rIHN1c3BfYWN0aXZpdHkKLXcgL3Vzci9iaW4vbm1hcCAtcCB4IC1rIHN1c3BfYWN0aXZpdHkKCiMjIHNzc2QKLWEgYWx3YXlzLGV4aXQgLUYgcGF0aD0vdXNyL2xpYmV4ZWMvc3NzZC9wMTFfY2hpbGQgLUYgcGVybT14IC1GIGF1aWQ+PTUwMCAtRiBhdWlkIT00Mjk0OTY3Mjk1IC1rIFQxMDc4X1ZhbGlkX0FjY291bnRzCi1hIGFsd2F5cyxleGl0IC1GIHBhdGg9L3Vzci9saWJleGVjL3Nzc2Qva3JiNV9jaGlsZCAtRiBwZXJtPXggLUYgYXVpZD49NTAwIC1GIGF1aWQhPTQyOTQ5NjcyOTUgLWsgVDEwNzhfVmFsaWRfQWNjb3VudHMKLWEgYWx3YXlzLGV4aXQgLUYgcGF0aD0vdXNyL2xpYmV4ZWMvc3NzZC9sZGFwX2NoaWxkIC1GIHBlcm09eCAtRiBhdWlkPj01MDAgLUYgYXVpZCE9NDI5NDk2NzI5NSAtayBUMTA3OF9WYWxpZF9BY2NvdW50cwotYSBhbHdheXMsZXhpdCAtRiBwYXRoPS91c3IvbGliZXhlYy9zc3NkL3NlbGludXhfY2hpbGQgLUYgcGVybT14IC1GIGF1aWQ+PTUwMCAtRiBhdWlkIT00Mjk0OTY3Mjk1IC1rIFQxMDc4X1ZhbGlkX0FjY291bnRzCi1hIGFsd2F5cyxleGl0IC1GIHBhdGg9L3Vzci9saWJleGVjL3Nzc2QvcHJveHlfY2hpbGQgLUYgcGVybT14IC1GIGF1aWQ+PTUwMCAtRiBhdWlkIT00Mjk0OTY3Mjk1IC1rIFQxMDc4X1ZhbGlkX0FjY291bnRzCgojIyBUMTAwMiBEYXRhIENvbXByZXNzZWQKCi13IC91c3IvYmluL3ppcCAtcCB4IC1rIERhdGFfQ29tcHJlc3NlZAotdyAvdXNyL2Jpbi9nemlwIC1wIHggLWsgRGF0YV9Db21wcmVzc2VkCi13IC91c3IvYmluL3RhciAtcCB4IC1rIERhdGFfQ29tcHJlc3NlZAotdyAvdXNyL2Jpbi9iemlwMiAtcCB4IC1rIERhdGFfQ29tcHJlc3NlZAoKLXcgL3Vzci9iaW4vbHppcCAtcCB4IC1rIERhdGFfQ29tcHJlc3NlZAotdyAvdXNyL2xvY2FsL2Jpbi9semlwIC1wIHggLWsgRGF0YV9Db21wcmVzc2VkCgotdyAvdXNyL2Jpbi9sejQgLXAgeCAtayBEYXRhX0NvbXByZXNzZWQKLXcgL3Vzci9sb2NhbC9iaW4vbHo0IC1wIHggLWsgRGF0YV9Db21wcmVzc2VkCgotdyAvdXNyL2Jpbi9sem9wIC1wIHggLWsgRGF0YV9Db21wcmVzc2VkCi13IC91c3IvbG9jYWwvYmluL2x6b3AgLXAgeCAtayBEYXRhX0NvbXByZXNzZWQKCi13IC91c3IvYmluL3BsemlwIC1wIHggLWsgRGF0YV9Db21wcmVzc2VkCi13IC91c3IvbG9jYWwvYmluL3BsemlwIC1wIHggLWsgRGF0YV9Db21wcmVzc2VkCgotdyAvdXNyL2Jpbi9wYnppcDIgLXAgeCAtayBEYXRhX0NvbXByZXNzZWQKLXcgL3Vzci9sb2NhbC9iaW4vcGJ6aXAyIC1wIHggLWsgRGF0YV9Db21wcmVzc2VkCgotdyAvdXNyL2Jpbi9sYnppcDIgLXAgeCAtayBEYXRhX0NvbXByZXNzZWQKLXcgL3Vzci9sb2NhbC9iaW4vbGJ6aXAyIC1wIHggLWsgRGF0YV9Db21wcmVzc2VkCgotdyAvdXNyL2Jpbi9waXh6IC1wIHggLWsgRGF0YV9Db21wcmVzc2VkCi13IC91c3IvbG9jYWwvYmluL3BpeHogLXAgeCAtayBEYXRhX0NvbXByZXNzZWQKCi13IC91c3IvYmluL3BpZ3ogLXAgeCAtayBEYXRhX0NvbXByZXNzZWQKLXcgL3Vzci9sb2NhbC9iaW4vcGlneiAtcCB4IC1rIERhdGFfQ29tcHJlc3NlZAotdyAvdXNyL2Jpbi91bnBpZ3ogLXAgeCAtayBEYXRhX0NvbXByZXNzZWQKLXcgL3Vzci9sb2NhbC9iaW4vdW5waWd6IC1wIHggLWsgRGF0YV9Db21wcmVzc2VkCgotdyAvdXNyL2Jpbi96c3RkIC1wIHggLWsgRGF0YV9Db21wcmVzc2VkCi13IC91c3IvbG9jYWwvYmluL3pzdGQgLXAgeCAtayBEYXRhX0NvbXByZXNzZWQKCiMjIEFkZGVkIHRvIGNhdGNoIG5ldGNhdCBvbiBVYnVudHUKLXcgL2Jpbi9uYy5vcGVuYnNkIC1wIHggLWsgc3VzcF9hY3Rpdml0eQotdyAvYmluL25jLnRyYWRpdGlvbmFsIC1wIHggLWsgc3VzcF9hY3Rpdml0eQoKIyMgU2JpbiBzdXNwaWNpb3VzIGFjdGl2aXR5Ci13IC9zYmluL2lwdGFibGVzIC1wIHggLWsgc2Jpbl9zdXNwCi13IC9zYmluL2lwNnRhYmxlcyAtcCB4IC1rIHNiaW5fc3VzcAotdyAvc2Jpbi9pZmNvbmZpZyAtcCB4IC1rIHNiaW5fc3VzcAotdyAvdXNyL3NiaW4vYXJwdGFibGVzIC1wIHggLWsgc2Jpbl9zdXNwCi13IC91c3Ivc2Jpbi9lYnRhYmxlcyAtcCB4IC1rIHNiaW5fc3VzcAotdyAvc2Jpbi94dGFibGVzLW5mdC1tdWx0aSAtcCB4IC1rIHNiaW5fc3VzcAotdyAvdXNyL3NiaW4vbmZ0IC1wIHggLWsgc2Jpbl9zdXNwCi13IC91c3Ivc2Jpbi90Y3BkdW1wIC1wIHggLWsgc2Jpbl9zdXNwCi13IC91c3Ivc2Jpbi90cmFjZXJvdXRlIC1wIHggLWsgc2Jpbl9zdXNwCi13IC91c3Ivc2Jpbi91ZncgLXAgeCAtayBzYmluX3N1c3AKCiMjIGRidXMtc2VuZCBpbnZvY2F0aW9uCiMjIyBtYXkgaW5kaWNhdGUgcHJpdmlsZWdlIGVzY2FsYXRpb24gQ1ZFLTIwMjEtMzU2MAotdyAvdXNyL2Jpbi9kYnVzLXNlbmQgLXAgeCAtayBkYnVzX3NlbmQKLXcgL3Vzci9iaW4vZ2RidXMgLXAgeCAtayBnZHVic19jYWxsCgojIyBwa2V4ZWMgaW52b2NhdGlvbgojIyMgbWF5IGluZGljYXRlIHByaXZpbGVnZSBlc2NhbGF0aW9uIENWRS0yMDIxLTQwMzQKLXcgL3Vzci9iaW4vcGtleGVjIC1wIHggLWsgcGtleGVjCgojIyBTdXNwaWNpb3VzIHNoZWxscwotdyAvYmluL2FzaCAtcCB4IC1rIHN1c3Bfc2hlbGwKLXcgL2Jpbi9jc2ggLXAgeCAtayBzdXNwX3NoZWxsCi13IC9iaW4vZmlzaCAtcCB4IC1rIHN1c3Bfc2hlbGwKLXcgL2Jpbi90Y3NoIC1wIHggLWsgc3VzcF9zaGVsbAotdyAvYmluL3RjbHNoIC1wIHggLWsgc3VzcF9zaGVsbAotdyAvYmluL3hvbnNoIC1wIHggLWsgc3VzcF9zaGVsbAotdyAvdXNyL2xvY2FsL2Jpbi94b25zaCAtcCB4IC1rIHN1c3Bfc2hlbGwKLXcgL2Jpbi9vcGVuIC1wIHggLWsgc3VzcF9zaGVsbAotdyAvYmluL3JiYXNoIC1wIHggLWsgc3VzcF9zaGVsbAoKIyBXZWIgU2VydmVyIEFjdHZpdHkKIyMgQ2hhbmdlIHRoZSBudW1iZXIgIjMzIiB0byB0aGUgSUQgb2YgeW91ciBXZWJTZXJ2ZXIgdXNlci4gRGVmYXVsdDogd3d3LWRhdGE6eDozMzozMwotYSBhbHdheXMsZXhpdCAtRiBhcmNoPWI2NCAtUyBleGVjdmUgLUYgZXVpZD0zMyAtayBkZXRlY3RfZXhlY3ZlX3d3dwoKIyMjIGh0dHBzOi8vZ2l0aHViLmNvbS90bXV4L3RtdXgKLXcgL2Jpbi90bXV4IC1wIHggLWsgc3VzcF9zaGVsbAotdyAvdXNyL2xvY2FsL2Jpbi90bXV4IC1wIHggLWsgc3VzcF9zaGVsbAoKIyMgU2hlbGwvcHJvZmlsZSBjb25maWd1cmF0aW9ucwotdyAvZXRjL3Byb2ZpbGUuZC8gLXAgd2EgLWsgc2hlbGxfcHJvZmlsZXMKLXcgL2V0Yy9wcm9maWxlIC1wIHdhIC1rIHNoZWxsX3Byb2ZpbGVzCi13IC9ldGMvc2hlbGxzIC1wIHdhIC1rIHNoZWxsX3Byb2ZpbGVzCi13IC9ldGMvYmFzaHJjIC1wIHdhIC1rIHNoZWxsX3Byb2ZpbGVzCi13IC9ldGMvY3NoLmNzaHJjIC1wIHdhIC1rIHNoZWxsX3Byb2ZpbGVzCi13IC9ldGMvY3NoLmxvZ2luIC1wIHdhIC1rIHNoZWxsX3Byb2ZpbGVzCi13IC9ldGMvZmlzaC8gLXAgd2EgLWsgc2hlbGxfcHJvZmlsZXMKLXcgL2V0Yy96c2gvIC1wIHdhIC1rIHNoZWxsX3Byb2ZpbGVzCgojIyMgaHR0cHM6Ly9naXRodWIuY29tL3h4aC94eGgKLXcgL3Vzci9sb2NhbC9iaW4veHhoLmJhc2ggLXAgeCAtayBzdXNwX3NoZWxsCi13IC91c3IvbG9jYWwvYmluL3h4aC54c2ggLXAgeCAtayBzdXNwX3NoZWxsCi13IC91c3IvbG9jYWwvYmluL3h4aC56c2ggLXAgeCAtayBzdXNwX3NoZWxsCgojIyBJbmplY3Rpb24KIyMjIFRoZXNlIHJ1bGVzIHdhdGNoIGZvciBjb2RlIGluamVjdGlvbiBieSB0aGUgcHRyYWNlIGZhY2lsaXR5LgojIyMgVGhpcyBjb3VsZCBpbmRpY2F0ZSBzb21lb25lIHRyeWluZyB0byBkbyBzb21ldGhpbmcgYmFkIG9yIGp1c3QgZGVidWdnaW5nCi1hIGFsd2F5cyxleGl0IC1GIGFyY2g9YjY0IC1TIHB0cmFjZSAtRiBhMD0weDQgLWsgY29kZV9pbmplY3Rpb24KLWEgYWx3YXlzLGV4aXQgLUYgYXJjaD1iNjQgLVMgcHRyYWNlIC1GIGEwPTB4NSAtayBkYXRhX2luamVjdGlvbgotYSBhbHdheXMsZXhpdCAtRiBhcmNoPWI2NCAtUyBwdHJhY2UgLUYgYTA9MHg2IC1rIHJlZ2lzdGVyX2luamVjdGlvbgotYSBhbHdheXMsZXhpdCAtRiBhcmNoPWI2NCAtUyBwdHJhY2UgLWsgdHJhY2luZwoKIyMgQW5vbnltb3VzIEZpbGUgQ3JlYXRpb24KIyMjIFRoZXNlIHJ1bGVzIHdhdGNoIHRoZSB1c2Ugb2YgbWVtZmRfY3JlYXRlCiMjIyAibWVtZmRfY3JlYXRlIiBjcmVhdGVzIGFub255bW91cyBmaWxlIGFuZCByZXR1cm5zIGEgZmlsZSBkZXNjcmlwdG9yIHRvIGFjY2VzcyBpdAojIyMgV2hlbiBjb21iaW5lZCB3aXRoICJmZXhlY3ZlIiBjYW4gYmUgdXNlZCB0byBzdGVhbHRoaWx5IHJ1biBiaW5hcmllcyBpbiBtZW1vcnkgd2l0aG91dCB0b3VjaGluZyBkaXNrCi1hIGFsd2F5cyxleGl0IC1GIGFyY2g9YjY0IC1TIG1lbWZkX2NyZWF0ZSAtRiBrZXk9YW5vbl9maWxlX2NyZWF0ZQoKIyMgUHJpdmlsZWdlIEFidXNlCiMjIyBUaGUgcHVycG9zZSBvZiB0aGlzIHJ1bGUgaXMgdG8gZGV0ZWN0IHdoZW4gYW4gYWRtaW4gbWF5IGJlIGFidXNpbmcgcG93ZXIgYnkgbG9va2luZyBpbiB1c2VyJ3MgaG9tZSBkaXIuCi1hIGFsd2F5cyxleGl0IC1GIGRpcj0vaG9tZSAtRiB1aWQ9MCAtRiBhdWlkPj0xMDAwIC1GIGF1aWQhPS0xIC1DIGF1aWQhPW9ial91aWQgLWsgcG93ZXJfYWJ1c2UKCiMgU29ja2V0IENyZWF0aW9ucwojIHdpbGwgY2F0Y2ggYm90aCBJUHY0IGFuZCBJUHY2CgotYSBhbHdheXMsZXhpdCAtRiBhcmNoPWIzMiAtUyBzb2NrZXQgLUYgYTA9MiAgLWsgbmV0d29ya19zb2NrZXRfY3JlYXRlZAotYSBhbHdheXMsZXhpdCAtRiBhcmNoPWI2NCAtUyBzb2NrZXQgLUYgYTA9MiAgLWsgbmV0d29ya19zb2NrZXRfY3JlYXRlZAoKLWEgYWx3YXlzLGV4aXQgLUYgYXJjaD1iMzIgLVMgc29ja2V0IC1GIGEwPTEwIC1rIG5ldHdvcmtfc29ja2V0X2NyZWF0ZWQKLWEgYWx3YXlzLGV4aXQgLUYgYXJjaD1iNjQgLVMgc29ja2V0IC1GIGEwPTEwIC1rIG5ldHdvcmtfc29ja2V0X2NyZWF0ZWQKCiMgU29mdHdhcmUgTWFuYWdlbWVudCAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCiMgUlBNIChSZWRoYXQvQ2VudE9TKQotdyAvdXNyL2Jpbi9ycG0gLXAgeCAtayBzb2Z0d2FyZV9tZ210Ci13IC91c3IvYmluL3l1bSAtcCB4IC1rIHNvZnR3YXJlX21nbXQKCiMgRE5GIChGZWRvcmEvUmVkSGF0IDgvQ2VudE9TIDgpCi13IC91c3IvYmluL2RuZiAtcCB4IC1rIHNvZnR3YXJlX21nbXQKCiMgWUFTVC9aeXBwZXIvUlBNIChTdVNFKQotdyAvc2Jpbi95YXN0IC1wIHggLWsgc29mdHdhcmVfbWdtdAotdyAvc2Jpbi95YXN0MiAtcCB4IC1rIHNvZnR3YXJlX21nbXQKLXcgL2Jpbi9ycG0gLXAgeCAtayBzb2Z0d2FyZV9tZ210Ci13IC91c3IvYmluL3p5cHBlciAtayBzb2Z0d2FyZV9tZ210CgojIERQS0cgLyBBUFQtR0VUIChEZWJpYW4vVWJ1bnR1KQotdyAvdXNyL2Jpbi9kcGtnIC1wIHggLWsgc29mdHdhcmVfbWdtdAotdyAvdXNyL2Jpbi9hcHQgLXAgeCAtayBzb2Z0d2FyZV9tZ210Ci13IC91c3IvYmluL2FwdC1hZGQtcmVwb3NpdG9yeSAtcCB4IC1rIHNvZnR3YXJlX21nbXQKLXcgL3Vzci9iaW4vYXB0LWdldCAtcCB4IC1rIHNvZnR3YXJlX21nbXQKLXcgL3Vzci9iaW4vYXB0aXR1ZGUgLXAgeCAtayBzb2Z0d2FyZV9tZ210Ci13IC91c3IvYmluL3dhamlnIC1wIHggLWsgc29mdHdhcmVfbWdtdAotdyAvdXNyL2Jpbi9zbmFwIC1wIHggLWsgc29mdHdhcmVfbWdtdAoKIyBQSVAoMykgKFB5dGhvbiBpbnN0YWxscykKLXcgL3Vzci9iaW4vcGlwIC1wIHggLWsgdGhpcmRfcGFydHlfc29mdHdhcmVfbWdtdAotdyAvdXNyL2xvY2FsL2Jpbi9waXAgLXAgeCAtayB0aGlyZF9wYXJ0eV9zb2Z0d2FyZV9tZ210Ci13IC91c3IvYmluL3BpcDMgLXAgeCAtayB0aGlyZF9wYXJ0eV9zb2Z0d2FyZV9tZ210Ci13IC91c3IvbG9jYWwvYmluL3BpcDMgLXAgeCAtayB0aGlyZF9wYXJ0eV9zb2Z0d2FyZV9tZ210Ci13IC91c3IvYmluL3BpcHggLXAgeCAtayB0aGlyZF9wYXJ0eV9zb2Z0d2FyZV9tZ210Ci13IC91c3IvbG9jYWwvYmluL3BpcHggLXAgeCAtayB0aGlyZF9wYXJ0eV9zb2Z0d2FyZV9tZ210CgojIG5wbQojIyBUMTA3MiB0aGlyZCBwYXJ0eSBzb2Z0d2FyZQojIyBodHRwczovL3d3dy5ucG1qcy5jb20KIyMgaHR0cHM6Ly9kb2NzLm5wbWpzLmNvbS9jbGkvdjYvY29tbWFuZHMvbnBtLWF1ZGl0Ci13IC91c3IvYmluL25wbSAtcCB4IC1rIHRoaXJkX3BhcnR5X3NvZnR3YXJlX21nbXQKCiMgQ29tcHJlaGVuc2l2ZSBQZXJsIEFyY2hpdmUgTmV0d29yayAoQ1BBTikgKENQQU4gaW5zdGFsbHMpCiMjIFQxMDcyIHRoaXJkIHBhcnR5IHNvZnR3YXJlCiMjIGh0dHBzOi8vd3d3LmNwYW4ub3JnCi13IC91c3IvYmluL2NwYW4gLXAgeCAtayB0aGlyZF9wYXJ0eV9zb2Z0d2FyZV9tZ210CgojIFJ1YnkgKFJ1YnlHZW1zIGluc3RhbGxzKQojIyBUMTA3MiB0aGlyZCBwYXJ0eSBzb2Z0d2FyZQojIyBodHRwczovL3J1YnlnZW1zLm9yZwotdyAvdXNyL2Jpbi9nZW0gLXAgeCAtayB0aGlyZF9wYXJ0eV9zb2Z0d2FyZV9tZ210CgojIEx1YVJvY2tzIChMdWEgaW5zdGFsbHMpCiMjIFQxMDcyIHRoaXJkIHBhcnR5IHNvZnR3YXJlCiMjIGh0dHBzOi8vbHVhcm9ja3Mub3JnCi13IC91c3IvYmluL2x1YXJvY2tzIC1wIHggLWsgdGhpcmRfcGFydHlfc29mdHdhcmVfbWdtdAoKIyBQYWNtYW4gKEFyY2ggTGludXgpCiMjIGh0dHBzOi8vd2lraS5hcmNobGludXgub3JnL3RpdGxlL1BhY21hbgojIyBUMTA3MiB0aGlyZCBwYXJ0eSBzb2Z0d2FyZQotdyAvZXRjL3BhY21hbi5jb25mIC1wIHggLWsgdGhpcmRfcGFydHlfc29mdHdhcmVfbWdtdAotdyAvZXRjL3BhY21hbi5kIC1wIHggLWsgdGhpcmRfcGFydHlfc29mdHdhcmVfbWdtdAogICAKIyBTcGVjaWFsIFNvZnR3YXJlIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKIyMgQ0hFRiBodHRwczovL3d3dy5jaGVmLmlvL2NoZWYvCi13IC9ldGMvY2hlZiAtcCB3YSAtayBzb2Z0X2NoZWYKCiMjIFNhbHQKIyMgaHR0cHM6Ly9zYWx0cHJvamVjdC5pby8KIyMgaHR0cHM6Ly9kb2NzLnNhbHRwcm9qZWN0LmlvL2VuL2xhdGVzdC9yZWYvY29uZmlndXJhdGlvbi9tYXN0ZXIuaHRtbAotdyAvZXRjL3NhbHQgLXAgd2EgLWsgc29mdF9zYWx0Ci13IC91c3IvbG9jYWwvZXRjL3NhbHQgLXAgd2EgLWsgc29mdF9zYWx0CgojIyBPdHRlcgojIyBodHRwczovL2luZWRvLmNvbS9vdHRlcgotdyAvZXRjL290dGVyIC1wIHdhIC1rIHNvZnRfb3R0ZXIKCiMjIFQxMDgxIENyZWRlbnRpYWxzIEluIEZpbGVzCi13IC91c3IvYmluL2dyZXAgLXAgeCAtayBzdHJpbmdfc2VhcmNoCi13IC91c3IvYmluL2VncmVwIC1wIHggLWsgc3RyaW5nX3NlYXJjaAotdyAvdXNyL2Jpbi91Z3JlcCAtcCB4IC1rIHN0cmluZ19zZWFyY2gKIyMjIG1hY09TCi13IC91c3IvbG9jYWwvYmluL2dyZXAgLXAgeCAtayBzdHJpbmdfc2VhcmNoCi13IC91c3IvbG9jYWwvYmluL2VncmVwIC1wIHggLWsgc3RyaW5nX3NlYXJjaAotdyAvdXNyL2xvY2FsL2Jpbi91Z3JlcCAtcCB4IC1rIHN0cmluZ19zZWFyY2gKCiMjIyBodHRwczovL2dpdGh1Yi5jb20vdG1iaW5jL2JncmVwCi13IC91c3IvYmluL2JncmVwIC1wIHggLWsgc3RyaW5nX3NlYXJjaAojIyMgbWFjT1MKLXcgL3Vzci9sb2NhbC9iaW4vYmdyZXAgLXAgeCAtayBzdHJpbmdfc2VhcmNoCgojIyMgaHR0cHM6Ly9naXRodWIuY29tL0J1cm50U3VzaGkvcmlwZ3JlcAotdyAvdXNyL2Jpbi9yZyAtcCB4IC1rIHN0cmluZ19zZWFyY2gKIyMjIG1hY09TCi13IC91c3IvbG9jYWwvYmluL3JnIC1wIHggLWsgc3RyaW5nX3NlYXJjaAoKIyMjIGh0dHBzOi8vZ2l0aHViLmNvbS9hd2duL2NncmVwCgotdyAvdXNyL2Jpbi9jZ3JlcCAtcCB4IC1rIHN0cmluZ19zZWFyY2gKIyMjIG1hY09TCi13IC91c3IvbG9jYWwvYmluL2NncmVwIC1wIHggLWsgc3RyaW5nX3NlYXJjaAoKIyMjIGh0dHBzOi8vZ2l0aHViLmNvbS9qcHI1L25ncmVwCi13IC91c3IvYmluL25ncmVwIC1wIHggLWsgc3RyaW5nX3NlYXJjaAojIyMgbWFjT1MKLXcgL3Vzci9sb2NhbC9iaW4vbmdyZXAgLXAgeCAtayBzdHJpbmdfc2VhcmNoCgojIyMgaHR0cHM6Ly9naXRodWIuY29tL3Zyb3RoYmVyZy92Z3JlcAotdyAvdXNyL2Jpbi92Z3JlcCAtcCB4IC1rIHN0cmluZ19zZWFyY2gKIyMjIG1hY09TCi13IC91c3IvbG9jYWwvYmluL3ZncmVwIC1wIHggLWsgc3RyaW5nX3NlYXJjaAoKIyMjIGh0dHBzOi8vZ2l0aHViLmNvbS9tb25vY2hyb21lZ2FuZS90aGVfcGxhdGludW1fc2VhcmNoZXIKLXcgL3Vzci9iaW4vcHQgLXAgeCAtayBzdHJpbmdfc2VhcmNoCiMjIyBtYWNPUwotdyAvdXNyL2xvY2FsL2Jpbi9wdCAtcCB4IC1rIHN0cmluZ19zZWFyY2gKCiMjIyBodHRwczovL2dpdGh1Yi5jb20vZ3ZhbnNpY2tsZS91Y2cKLXcgL3Vzci9iaW4vdWNnIC1wIHggLWsgc3RyaW5nX3NlYXJjaAojIyMgbWFjT1MKLXcgL3Vzci9sb2NhbC9iaW4vdWNnIC1wIHggLWsgc3RyaW5nX3NlYXJjaAoKIyMjIGh0dHBzOi8vZ2l0aHViLmNvbS9nZ3JlZXIvdGhlX3NpbHZlcl9zZWFyY2hlcgotdyAvdXNyL2Jpbi9hZyAtcCB4IC1rIHN0cmluZ19zZWFyY2gKIyMjIG1hY09TCi13IC91c3IvbG9jYWwvYmluL2FnIC1wIHggLWsgc3RyaW5nX3NlYXJjaAoKIyMjIGh0dHBzOi8vZ2l0aHViLmNvbS9iZXlvbmRncmVwL2FjazMKIyMjIGh0dHBzOi8vYmV5b25kZ3JlcC5jb20KLXcgL3Vzci9iaW4vYWNrIC1wIHggLWsgc3RyaW5nX3NlYXJjaAotdyAvdXNyL2xvY2FsL2Jpbi9hY2sgLXAgeCAtayBzdHJpbmdfc2VhcmNoCi13IC91c3IvYmluL3NlbWdyZXAgLXAgeCAtayBzdHJpbmdfc2VhcmNoCiMjIyBtYWNPUwotdyAvdXNyL2xvY2FsL2Jpbi9zZW1ncmVwIC1wIHggLWsgc3RyaW5nX3NlYXJjaAoKIyMgRG9ja2VyCi13IC91c3IvYmluL2RvY2tlcmQgLWsgZG9ja2VyCi13IC91c3IvYmluL2RvY2tlciAtayBkb2NrZXIKLXcgL3Vzci9iaW4vZG9ja2VyLWNvbnRhaW5lcmQgLWsgZG9ja2VyCi13IC91c3IvYmluL2RvY2tlci1ydW5jIC1rIGRvY2tlcgotdyAvdmFyL2xpYi9kb2NrZXIgLXAgd2EgLWsgZG9ja2VyCi13IC9ldGMvZG9ja2VyIC1rIGRvY2tlcgotdyAvZXRjL3N5c2NvbmZpZy9kb2NrZXIgLWsgZG9ja2VyCi13IC9ldGMvc3lzY29uZmlnL2RvY2tlci1zdG9yYWdlIC1rIGRvY2tlcgotdyAvdXNyL2xpYi9zeXN0ZW1kL3N5c3RlbS9kb2NrZXIuc2VydmljZSAtayBkb2NrZXIKLXcgL3Vzci9saWIvc3lzdGVtZC9zeXN0ZW0vZG9ja2VyLnNvY2tldCAtayBkb2NrZXIKCiMjIFZpcnR1YWxpemF0aW9uIHN0dWZmCi13IC91c3IvYmluL3FlbXUtc3lzdGVtLXg4Nl82NCAtcCB4IC1rIHFlbXUtc3lzdGVtLXg4Nl82NAotdyAvdXNyL2Jpbi9xZW11LWltZyAtcCB4IC1rIHFlbXUtaW1nCi13IC91c3IvYmluL3FlbXUta3ZtIC1wIHggLWsgcWVtdS1rdm0KLXcgL3Vzci9iaW4vcWVtdSAtcCB4IC1rIHFlbXUKLXcgL3Vzci9iaW4vdmlydHVhbGJveCAtcCB4IC1rIHZpcnR1YWxib3gKLXcgL3Vzci9iaW4vdmlydC1tYW5hZ2VyIC1wIHggLWsgdmlydC1tYW5hZ2VyCi13IC91c3IvYmluL1ZCb3hNYW5hZ2UgLXAgeCAtayBWQm94TWFuYWdlCgojIyBLdWJlbGV0Ci13IC91c3IvYmluL2t1YmVsZXQgLWsga3ViZWxldAoKIyBpcGMgc3lzdGVtIGNhbGwKIyAvdXNyL2luY2x1ZGUvbGludXgvaXBjLmgKCiMjIG1zZ2N0bAojLWEgYWx3YXlzLGV4aXQgLVMgaXBjIC1GIGEwPTE0IC1rIEludGVyLVByb2Nlc3NfQ29tbXVuaWNhdGlvbgojIyBtc2dnZXQKIy1hIGFsd2F5cyxleGl0IC1TIGlwYyAtRiBhMD0xMyAtayBJbnRlci1Qcm9jZXNzX0NvbW11bmljYXRpb24KIyMgVXNlIHRoZXNlIGxpbmVzIG9uIHg4Nl82NCwgaWE2NCBpbnN0ZWFkCi1hIGFsd2F5cyxleGl0IC1GIGFyY2g9YjY0IC1TIG1zZ2N0bCAtayBJbnRlci1Qcm9jZXNzX0NvbW11bmljYXRpb24KLWEgYWx3YXlzLGV4aXQgLUYgYXJjaD1iNjQgLVMgbXNnZ2V0IC1rIEludGVyLVByb2Nlc3NfQ29tbXVuaWNhdGlvbgoKIyMgc2VtY3RsCiMtYSBhbHdheXMsZXhpdCAtUyBpcGMgLUYgYTA9MyAtayBJbnRlci1Qcm9jZXNzX0NvbW11bmljYXRpb24KIyMgc2VtZ2V0CiMtYSBhbHdheXMsZXhpdCAtUyBpcGMgLUYgYTA9MiAtayBJbnRlci1Qcm9jZXNzX0NvbW11bmljYXRpb24KIyMgc2Vtb3AKIy1hIGFsd2F5cyxleGl0IC1TIGlwYyAtRiBhMD0xIC1rIEludGVyLVByb2Nlc3NfQ29tbXVuaWNhdGlvbgojIyBzZW10aW1lZG9wCiMtYSBhbHdheXMsZXhpdCAtUyBpcGMgLUYgYTA9NCAtayBJbnRlci1Qcm9jZXNzX0NvbW11bmljYXRpb24KIyMgVXNlIHRoZXNlIGxpbmVzIG9uIHg4Nl82NCwgaWE2NCBpbnN0ZWFkCi1hIGFsd2F5cyxleGl0IC1GIGFyY2g9YjY0IC1TIHNlbWN0bCAtayBJbnRlci1Qcm9jZXNzX0NvbW11bmljYXRpb24KLWEgYWx3YXlzLGV4aXQgLUYgYXJjaD1iNjQgLVMgc2VtZ2V0IC1rIEludGVyLVByb2Nlc3NfQ29tbXVuaWNhdGlvbgotYSBhbHdheXMsZXhpdCAtRiBhcmNoPWI2NCAtUyBzZW1vcCAtayBJbnRlci1Qcm9jZXNzX0NvbW11bmljYXRpb24KLWEgYWx3YXlzLGV4aXQgLUYgYXJjaD1iNjQgLVMgc2VtdGltZWRvcCAtayBJbnRlci1Qcm9jZXNzX0NvbW11bmljYXRpb24KCiMjIHNobWN0bAojLWEgYWx3YXlzLGV4aXQgLVMgaXBjIC1GIGEwPTI0IC1rIEludGVyLVByb2Nlc3NfQ29tbXVuaWNhdGlvbgojIyBzaG1nZXQKIy1hIGFsd2F5cyxleGl0IC1TIGlwYyAtRiBhMD0yMyAtayBJbnRlci1Qcm9jZXNzX0NvbW11bmljYXRpb24KIyMgVXNlIHRoZXNlIGxpbmVzIG9uIHg4Nl82NCwgaWE2NCBpbnN0ZWFkCi1hIGFsd2F5cyxleGl0IC1GIGFyY2g9YjY0IC1TIHNobWN0bCAtayBJbnRlci1Qcm9jZXNzX0NvbW11bmljYXRpb24KLWEgYWx3YXlzLGV4aXQgLUYgYXJjaD1iNjQgLVMgc2htZ2V0IC1rIEludGVyLVByb2Nlc3NfQ29tbXVuaWNhdGlvbgoKIyBIaWdoIFZvbHVtZSBFdmVudHMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKIyMgRGlzYWJsZSB0aGVzZSBydWxlcyBpZiB0aGV5IGNyZWF0ZSB0b28gbWFueSBldmVudHMgaW4geW91ciBlbnZpcm9ubWVudAoKIyMgQ29tbW9uIFNoZWxscwotdyAvYmluL2Jhc2ggLXAgeCAtayBzdXNwX3NoZWxsCi13IC9iaW4vZGFzaCAtcCB4IC1rIHN1c3Bfc2hlbGwKLXcgL2Jpbi9idXN5Ym94IC1wIHggLWsgc3VzcF9zaGVsbAotdyAvYmluL3pzaCAtcCB4IC1rIHN1c3Bfc2hlbGwKLXcgL2Jpbi9zaCAtcCB4IC1rIHN1c3Bfc2hlbGwKLXcgL2Jpbi9rc2ggLXAgeCAtayBzdXNwX3NoZWxsCgojIyBSb290IGNvbW1hbmQgZXhlY3V0aW9ucwotYSBhbHdheXMsZXhpdCAtRiBhcmNoPWI2NCAtRiBldWlkPTAgLUYgYXVpZD49MTAwMCAtRiBhdWlkIT0tMSAtUyBleGVjdmUgLWsgcm9vdGNtZAoKIyMgRmlsZSBEZWxldGlvbiBFdmVudHMgYnkgVXNlcgotYSBhbHdheXMsZXhpdCAtRiBhcmNoPWI2NCAtUyBybWRpciAtUyB1bmxpbmsgLVMgdW5saW5rYXQgLVMgcmVuYW1lIC1TIHJlbmFtZWF0IC1GIGF1aWQ+PTEwMDAgLUYgYXVpZCE9LTEgLWsgZGVsZXRlCgojIyBGaWxlIEFjY2VzcwojIyMgVW5hdXRob3JpemVkIEFjY2VzcyAodW5zdWNjZXNzZnVsKQotYSBhbHdheXMsZXhpdCAtRiBhcmNoPWI2NCAtUyBjcmVhdCAtUyBvcGVuIC1TIG9wZW5hdCAtUyBvcGVuX2J5X2hhbmRsZV9hdCAtUyB0cnVuY2F0ZSAtUyBmdHJ1bmNhdGUgLUYgZXhpdD0tRUFDQ0VTIC1GIGF1aWQ+PTEwMDAgLUYgYXVpZCE9LTEgLWsgZmlsZV9hY2Nlc3MKLWEgYWx3YXlzLGV4aXQgLUYgYXJjaD1iNjQgLVMgY3JlYXQgLVMgb3BlbiAtUyBvcGVuYXQgLVMgb3Blbl9ieV9oYW5kbGVfYXQgLVMgdHJ1bmNhdGUgLVMgZnRydW5jYXRlIC1GIGV4aXQ9LUVQRVJNIC1GIGF1aWQ+PTEwMDAgLUYgYXVpZCE9LTEgLWsgZmlsZV9hY2Nlc3MKCiMjIyBVbnN1Y2Nlc3NmdWwgQ3JlYXRpb24KLWEgYWx3YXlzLGV4aXQgLUYgYXJjaD1iNjQgLVMgbWtkaXIsY3JlYXQsbGluayxzeW1saW5rLG1rbm9kLG1rbm9kYXQsbGlua2F0LHN5bWxpbmthdCAtRiBleGl0PS1FQUNDRVMgLWsgZmlsZV9jcmVhdGlvbgotYSBhbHdheXMsZXhpdCAtRiBhcmNoPWI2NCAtUyBta2RpcixsaW5rLHN5bWxpbmssbWtkaXJhdCAtRiBleGl0PS1FUEVSTSAtayBmaWxlX2NyZWF0aW9uCgojIyMgVW5zdWNjZXNzZnVsIE1vZGlmaWNhdGlvbgotYSBhbHdheXMsZXhpdCAtRiBhcmNoPWI2NCAtUyByZW5hbWUgLVMgcmVuYW1lYXQgLVMgdHJ1bmNhdGUgLVMgY2htb2QgLVMgc2V0eGF0dHIgLVMgbHNldHhhdHRyIC1TIHJlbW92ZXhhdHRyIC1TIGxyZW1vdmV4YXR0ciAtRiBleGl0PS1FQUNDRVMgLWsgZmlsZV9tb2RpZmljYXRpb24KLWEgYWx3YXlzLGV4aXQgLUYgYXJjaD1iNjQgLVMgcmVuYW1lIC1TIHJlbmFtZWF0IC1TIHRydW5jYXRlIC1TIGNobW9kIC1TIHNldHhhdHRyIC1TIGxzZXR4YXR0ciAtUyByZW1vdmV4YXR0ciAtUyBscmVtb3ZleGF0dHIgLUYgZXhpdD0tRVBFUk0gLWsgZmlsZV9tb2RpZmljYXRpb24KCiMjIDMyYml0IEFQSSBFeHBsb2l0YXRpb24KIyMjIElmIHlvdSBhcmUgb24gYSA2NCBiaXQgcGxhdGZvcm0sIGV2ZXJ5dGhpbmcgX3Nob3VsZF8gYmUgcnVubmluZwojIyMgaW4gNjQgYml0IG1vZGUuIFRoaXMgcnVsZSB3aWxsIGRldGVjdCBhbnkgdXNlIG9mIHRoZSAzMiBiaXQgc3lzY2FsbHMKIyMjIGJlY2F1c2UgdGhpcyBtaWdodCBiZSBhIHNpZ24gb2Ygc29tZW9uZSBleHBsb2l0aW5nIGEgaG9sZSBpbiB0aGUgMzIKIyMjIGJpdCBBUEkuCi1hIGFsd2F5cyxleGl0IC1GIGFyY2g9YjMyIC1TIGFsbCAtayAzMmJpdF9hcGkKCiMgTWFrZSBUaGUgQ29uZmlndXJhdGlvbiBJbW11dGFibGUgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCiMjLWUgMgo="
echo $rules | base64 -d > /etc/audit/rules.d/audit.rules && chmod 600 /etc/audit/rules.d/audit.rules

echo ">auditctl -s:" >> $log
auditctl -s >> $log
echo ">auditctl -l | wc -l:" >> $log
auditctl -l | wc -l >> $log

if [ `auditctl -l | wc -l` -le 300 ]; then
    echo "ERROR: The rules didn't apply" |& tee -a $log >&2; exit 1;
fi

# check major version auditd
if [ `auditctl -v | sed -r "s/[^0-9]*([0-9]+)\..+/\1/g"` -ge 3 ]; then 
    audit=/etc/audit/auditd.conf
    plugins=/etc/audit/plugins.d/syslog.conf
    conf="active = yes\ndirection = out\npath = /sbin/audisp-syslog\ntype = always\nargs = LOG_INFO LOG_LOCAL6\nformat = string"
else
    audit=/etc/audisp/audispd.conf
    plugins=/etc/audisp/plugins.d/syslog.conf
    conf="active = yes\ndirection = out\npath = builtin_syslog\ntype = builtin\nargs = LOG_INFO LOG_LOCAL6"
fi

# edit plugins config
if [ ! -f $plugins.bak ]; then
    cat $plugins>$plugins.bak 2>/dev/null; echo "INFO: The current configuration of $plugins is saved in $plugins.bak"
fi
echo -e $conf > $plugins
echo $plugins: |& tee -a $log && diff $plugins $plugins.bak |& tee -a $log

# edit audit config
if [ ! -f $audit.bak ]; then
    cat $audit>$audit.bak 2>/dev/null; echo "INFO: The current configuration of $audit is saved in $audit.bak"
fi
sed -ri "s/^\s*name_format\s*=\s*.+/name_format = HOSTNAME/g" $audit
sed -ri "s/^\s*space_left\s*=\s*.+/space_left = 99/g" $audit
sed -ri "s/^\s*space_left_action\s*=\s*.+/space_left_action = syslog/g" $audit
sed -ri "s/^\s*admin_space_left\s*=\s*.+/admin_space_left = 90/g" $audit
sed -ri "s/^\s*admin_space_left_action\s*=\s*[Ee][Mm][Aa][Ii][Ll]/admin_space_left_action = syslog/g" $audit
echo $audit: |& tee -a $log && diff $audit $audit.bak |& tee -a $log

# edit rsyslog config
if [ ! -d /etc/rsyslog.d ]; then mkdir /etc/rsyslog.d; echo "WARNING: /etc/rsyslog.d wasn``t exist and was created">>$log; fi
echo -e "$([ $host ] && [ $port ] && echo "local6.=info @@$host:$port\n")$([ $journal ] && echo "local6.=info $journal\n")" > /etc/rsyslog.d/siem.conf || { echo "ERROR: Cannot create /etc/rsyslog.d/siem.conf" |& tee -a $log; exit 1; }

# Restart daemons
[ `which systemctl` ] && systemctl restart auditd  |& tee -a $log || [ `which service` ] && { service auditd  stop |& tee -a $log && service auditd  start |& tee -a $log; } || { kill -HUP $(ps -C auditd   -o pid=) && grep auditd   /var/log/syslog | tail -n 10 |& tee -a $log; }
[ `which systemctl` ] && systemctl restart rsyslog |& tee -a $log || [ `which service` ] && { service rsyslog stop |& tee -a $log && service rsyslog start |& tee -a $log; } || { kill -HUP $(ps -C rsyslogd -o pid=) && grep rsyslogd /var/log/syslog | tail -n 10 |& tee -a $log; }

sleep 10s

# Statuses
[ `which systemctl` ] && systemctl status auditd  |& tee -a $log || service auditd  status |& tee -a $log
[ `which systemctl` ] && systemctl status rsyslog |& tee -a $log || service rsyslog status |& tee -a $log


[ $host ] && [ $port ] && {
    echo "INFO: Checking communication with SIEM: An attempt to send a test message along with a log of changes"
    timeout 5 bash -c 'echo "<1>$(LANG=us_US date +"%B %d %Y %T") $(hostname) audispd[000000]: node=$(hostname) type=CONFIG_CHANGE msg=setting auditd finished $(hostname) [$(hostname -i)]:\n$(sed -zre ''s/\\n/\\\\n/g'' -zre ''s/\"/\'\''/g'' '$log')" > /dev/tcp/'$host'/'$port' ' && echo "INFO: $host:$port avaible" || echo "INFO: $host:$port unavaible"
}
#echo "<1>$(LANG=us_US date +"%B %d %Y %T") $(hostname) audispd[000000]: node=$(hostname) type=CONFIG_CHANGE msg=setting auditd finished $(hostname) [$(hostname -i)]:\n$(sed -zr 's/\n/\\n/g' $log)" > /dev/tcp/$host/$port
