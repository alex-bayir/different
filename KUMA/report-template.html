<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–û—Ç—á–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (2025-08-16 - 2025-08-18)</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.3.0/papaparse.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 4px;
            background-color: #f5f5f5;
        }

        .container {
            max-width: 210mm;
            margin: 0 auto;
            padding: 4px;
            text-align: center;

            background-color: white;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);

        }

        h1 {
            color: #333;
            font-size: 24px;
        }

        h2 {
            color: #333;
            font-size: 20px;
        }

        .charts-container {
            display: flex;
            flex-wrap: wrap;
            gap: 4px;
        }

        .chart-box {
            flex: 1 1 300px;
            min-width: 300px;
            max-width: 400px;
            max-height: 200px;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background-color: white;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
            font-size: 16px;
        }

        th, td {
            border: 1px solid #ddd;
            padding: 2px;
            text-align: left;
        }

        th {
            background-color: #f2f2f2;
        }

        .loading {
            margin: 20px 0;
            color: #666;
            font-style: italic;
        }

        .hide {
            display: none;
        }

        .no-print {
            display: block;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –ø–µ—á–∞—Ç–∏ */
        @media print {
            @page {
                margin: 0;
                size: auto;
            }

            .no-print {
                display: none !important;
            }

            .print-only {
                display: block !important;
            }

            body {
                margin: 0;
                font-size: 12pt;
                line-height: 1.4;
            }

            /* –£–±–∏—Ä–∞–µ–º —Ñ–æ–Ω—ã –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ —á–µ—Ä–Ω–∏–ª */
            * {
                background: transparent !important;
                color: black !important;
                box-shadow: none !important;
                text-shadow: none !important;
            }

            /* –£–∫–∞–∑—ã–≤–∞–µ–º –æ–±–ª–∞—Å—Ç–∏ –ø–µ—á–∞—Ç–∏ */
            .print-area {
                page-break-inside: avoid;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="print-area">
            <img src="https://lp.kaspersky.com/ru/wp-content/themes/kuma/images/hero-bg.jpg" alt="logo" style="margin-top: 20px; max-height: 100px;"></img>
            <h1 style="text-align:center">–û—Ç—á–µ—Ç –ø–æ —Å–æ–±—ã—Ç–∏—è–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏</br>–∑–∞ –ø–µ—Ä–∏–æ–¥: {{events-date-export}}</h1>
            <div class="loading" id="loading">–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...</div>
            <div id="report-content" style="display: none;">
                <h2 style="text-align:center">–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π –ø–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º</h2>
                <div class="charts-container">
                    <div class="chart-box">
                        <canvas id="eventsChart"></canvas>
                    </div>
                    <div class="chart-box">
                        <canvas id="incidentsChart"></canvas>
                    </div>
                </div>
                <table id="events-table">
                    <thead>
                        <tr>
                            <th style="text-align:center">–ò—Å—Ç–æ—á–Ω–∏–∫ —Å–æ–±—ã—Ç–∏–π</th>
                            <th style="text-align:center">–°–æ–±—ã—Ç–∏–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏</th>
                            <th style="text-align:center">–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤</th>
                        </tr>
                    </thead>
                    <tbody id="events-table-body">
                    </tbody>
                </table>
            </div>
            <div class="print-area">
                <h2 style="text-align:center">–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –∏–Ω—Ü–∏–¥–µ–Ω—Ç—ã</h2>
                <div class="charts-container">
                    <div class="chart-box">
                        <canvas id="alertsPriorityChart"></canvas>
                    </div>
                    <div class="chart-box">
                        <canvas id="alertsTypesChart"></canvas>
                    </div>
                </div>
                <table id="alerts-table">
                    <thead>
                        <tr>
                            <th style="text-align:center">–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –∏–Ω—Ü–∏–¥–µ–Ω—Ç—ã</th>
                            <th style="text-align:center">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ</th>
                        </tr>
                    </thead>
                    <tbody id="alerts-table-body">
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        String.prototype.ellip = function (length) {
          return this.length > length ? this.substring(0, length) + "‚Ä¶" : this;
        }
        // –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ CSV –¥–∞–Ω–Ω—ã–µ
        const eventsCSV = `source,base,correlated\n{{events-data-export}}`;
        const alertsCSV = `count,priority,rule\n{{alerts-data-export}}`;

        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏ –¥–∏–∞–≥—Ä–∞–º–º
        let events = [];
        let alerts = [];
        let descriptions = [];
        let charts = {
            eventsChart: null,
            incidentsChart: null,
            alertsPriorityChart: null,
            alertsTypesChart: null
        };
        
        // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–∏—Å–µ–ª —Å –ø—Ä–æ–±–µ–ª–∞–º–∏
        function formatNumber(num) {
            return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, " ");
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –æ—Ç—á–µ—Ç–æ–≤
        function initializeReport() {

            // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ —Å–æ–±—ã—Ç–∏–π
            events = Papa.parse(eventsCSV, { header: true }).data.map(row => ({
                source: row['source'],
                events: parseInt(row['base']) || 0,
                incidents: parseInt(row['correlated']) || 0
            })).filter(item => item.source); // –§–∏–ª—å—Ç—Ä—É–µ–º –ø—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏
            
            // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ –æ–ø–æ–≤–µ—â–µ–Ω–∏–π
            alerts = Papa.parse(alertsCSV, { header: true }).data.map(row => ({
                count: parseInt(row['count']) || 0,
                priority: row['priority'],
                id: row['id']
            })).filter(item => item.rule); // –§–∏–ª—å—Ç—Ä—É–µ–º –ø—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏

            // –°–æ—Ä—Ç–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ
            events.sort((a, b) => b.events - a.events);
            alerts.sort((a, b) => b.count - a.count);
            
            // –°—Ç—Ä–æ–∏–º –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
            createEventsChart();
            createIncidentsChart();
            createAlertsPriorityChart();
            createAlertsTypesChart();
            
            // –ó–∞–ø–æ–ª–Ω—è–µ–º —Ç–∞–±–ª–∏—Ü—ã
            fillEventsTable();
            fillAlertsTable();
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—Ç—á–µ—Ç
            document.getElementById('loading').style.display = 'none';
            document.getElementById('report-content').style.display = 'block';
        }
        
        // –°–æ–∑–¥–∞–Ω–∏–µ –¥–∏–∞–≥—Ä–∞–º–º—ã —Å–æ–±—ã—Ç–∏–π
        function createEventsChart() {
            const ctx = document.getElementById('eventsChart').getContext('2d');
            
            // –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö (–ø–µ—Ä–≤—ã–µ 5 + –æ—Å—Ç–∞–ª—å–Ω—ã–µ)
            const topEvents = events.slice(0, 5);
            const othersEvents = events.slice(5).reduce((sum, item) => sum + item.events, 0);
            
            const labels = [
                ...topEvents.map(item => `${item.source.ellip(16)}: ${formatNumber(item.events)}`),
                `–û—Å—Ç–∞–ª—å–Ω—ã–µ: ${formatNumber(othersEvents)}`
            ];
            
            const data = [
                ...topEvents.map(item => item.events),
                othersEvents
            ];
            
            if (charts.eventsChart) {
                charts.eventsChart.destroy();
            }
            
            charts.eventsChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: labels,
                    datasets: [{
                        data: data,
                        borderWidth: 0,
                        backgroundColor: [
                            '#FF6384',
                            '#36A2EB',
                            '#FFCE56',
                            '#4BC0C0',
                            '#9966FF',
                            '#C9CBCF'
                        ]
                    }]
                },
                options: getChartOptions('–°–æ–±—ã—Ç–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ø–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º')
            });
        }
        
        // –°–æ–∑–¥–∞–Ω–∏–µ –¥–∏–∞–≥—Ä–∞–º–º—ã –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤
        function createIncidentsChart() {
            const ctx = document.getElementById('incidentsChart').getContext('2d');
            
            // –§–∏–ª—å—Ç—Ä—É–µ–º —Ç–æ–ª—å–∫–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ —Å –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞–º–∏
            const withIncidents = events.filter(item => item.incidents > 0);
            
            // –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö (–ø–µ—Ä–≤—ã–µ 5 + –æ—Å—Ç–∞–ª—å–Ω—ã–µ)
            const topIncidents = withIncidents.slice(0, 5);
            const othersIncidents = withIncidents.slice(5).reduce((sum, item) => sum + item.incidents, 0);
            
            const labels = [
                ...topIncidents.map(item => `${item.source.ellip(16)}: ${formatNumber(item.incidents)}`),
                othersIncidents > 0 ? `–û—Å—Ç–∞–ª—å–Ω—ã–µ: ${formatNumber(othersIncidents)}` : null
            ].filter(Boolean);
            
            const data = [
                ...topIncidents.map(item => item.incidents),
                othersIncidents
            ].filter(item => item > 0);
            
            if (charts.incidentsChart) {
                charts.incidentsChart.destroy();
            }
            
            charts.incidentsChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: labels,
                    datasets: [{
                        data: data,
                        borderWidth: 0,
                        backgroundColor: [
                            '#FF6384',
                            '#36A2EB',
                            '#FFCE56',
                            '#4BC0C0',
                            '#9966FF',
                            '#C9CBCF'
                        ].slice(0, labels.length)
                    }]
                },
                options: getChartOptions('–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –∏–Ω—Ü–∏–¥–µ–Ω—Ç—ã –ø–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º')
            });
        }
        
        // –°–æ–∑–¥–∞–Ω–∏–µ –¥–∏–∞–≥—Ä–∞–º–º—ã –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤ –æ–ø–æ–≤–µ—â–µ–Ω–∏–π
        function createAlertsPriorityChart() {
            const ctx = document.getElementById('alertsPriorityChart').getContext('2d');
            
            // –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º
            const priorityGroups = {
                '–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π': 0,
                '–í—ã—Å–æ–∫–∏–π': 0,
                '–°—Ä–µ–¥–Ω–∏–π': 0,
                '–ù–∏–∑–∫–∏–π': 0
            };
            
            alerts.forEach(alert => {
                if (alert.priority.includes('‚ò¢Ô∏è')) priorityGroups['–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π'] += alert.count;
                else if (alert.priority.includes('üî¥')) priorityGroups['–í—ã—Å–æ–∫–∏–π'] += alert.count;
                else if (alert.priority.includes('üü°')) priorityGroups['–°—Ä–µ–¥–Ω–∏–π'] += alert.count;
                else if (alert.priority.includes('üü¢')) priorityGroups['–ù–∏–∑–∫–∏–π'] += alert.count;
            });
            
            const labels = Object.keys(priorityGroups).map(key => 
                `${key.ellip(16)}: ${formatNumber(priorityGroups[key])}`
            );
            const data = Object.values(priorityGroups);
            
            if (charts.alertsPriorityChart) {
                charts.alertsPriorityChart.destroy();
            }
            
            charts.alertsPriorityChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: labels,
                    datasets: [{
                        data: data,
                        borderWidth: 0,
                        backgroundColor: [
                            '#940000',
                            '#FF0000',
                            '#FFFF00',
                            '#00FF00'
                        ]
                    }]
                },
                options: getChartOptions('–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –∏–Ω—Ü–∏–¥–µ–Ω—Ç—ã –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º')
            });
        }
        
        // –°–æ–∑–¥–∞–Ω–∏–µ –¥–∏–∞–≥—Ä–∞–º–º—ã —Ç–∏–ø–æ–≤ –æ–ø–æ–≤–µ—â–µ–Ω–∏–π
        function createAlertsTypesChart() {
            const ctx = document.getElementById('alertsTypesChart').getContext('2d');
            
            // –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö (–ø–µ—Ä–≤—ã–µ 3 + –æ—Å—Ç–∞–ª—å–Ω—ã–µ)
            const topAlerts = alerts.slice(0, 5);
            const othersAlerts = alerts.slice(5).reduce((sum, item) => sum + item.count, 0);
            
            const labels = [
                ...topAlerts.map(item => `${item.rule.ellip(16)}: ${formatNumber(item.count)}`),
                `–î—Ä—É–≥–∏–µ: ${formatNumber(othersAlerts)}`
            ];
            
            const data = [
                ...topAlerts.map(item => item.count),
                othersAlerts
            ];
            
            if (charts.alertsTypesChart) {
                charts.alertsTypesChart.destroy();
            }
            
            charts.alertsTypesChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: labels,
                    datasets: [{
                        data: data,
                        borderWidth: 0,
                        backgroundColor: [
                            '#FF6384',
                            '#36A2EB',
                            '#FFCE56',
                            '#4BC0C0',
                            '#9966FF',
                            '#C9CBCF'
                        ]
                    }]
                },
                options: getChartOptions('–û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∏–ø—ã –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤')
            });
        }
        
        // –û–±—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–∏–∞–≥—Ä–∞–º–º
        function getChartOptions(title) {
            return {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'right',
                        labels: {
                            boxWidth: 12,
                            font: {
                                size: 12,
                                family: 'Consolas'
                            }
                        }
                    },
                    tooltip: {
                        callbacks: {
                            label: (context) => (context.label || '') 
                        }
                    },
                    title: {
                        display: true,
                        padding: 0,
                        text: title,
                        font: {
                            size: 16
                        }
                    }
                }
            };
        }
        
        // –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã —Å–æ–±—ã—Ç–∏–π
        function fillEventsTable() {
            const tbody = document.getElementById('events-table-body');
            tbody.innerHTML = '';
            
            events.forEach(item => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td style="text-align:left">${item.source}</td>
                    <td style="text-align:right">${formatNumber(item.events)}</td>
                    <td style="text-align:right">${formatNumber(item.incidents)}</td>
                `;
                tbody.appendChild(row);
            });
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∏—Ç–æ–≥–æ–≤—É—é —Å—Ç—Ä–æ–∫—É
            const totalRow = document.createElement('tr');
            totalRow.style.fontWeight = 'bold';
            const totalEvents = events.reduce((sum, item) => sum + item.events, 0);
            const totalIncidents = events.reduce((sum, item) => sum + item.incidents, 0);
            totalRow.innerHTML = `
                <td style="text-align:left">–ò—Ç–æ–≥–æ</td>
                <td style="text-align:right">${formatNumber(totalEvents)}</td>
                <td style="text-align:right">${formatNumber(totalIncidents)}</td>
            `;
            tbody.appendChild(totalRow);
        }
        
        // –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã –æ–ø–æ–≤–µ—â–µ–Ω–∏–π
        function fillAlertsTable() {
            const tbody = document.getElementById('alerts-table-body');
            tbody.innerHTML = '';
            
            alerts.forEach(item => {
                const row = document.createElement('tr');
                
                // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–ª–∞—Å—Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞ –¥–ª—è —Å—Ç–∏–ª–∏–∑–∞—Ü–∏–∏
                let priority = '';
                if (item.priority.includes('‚ò¢Ô∏è')) priority = '<svg width="12" height="12" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M 2.5 0.5 c -0.8284 0 -1.5 0.6716 -1.5 1.5 c 0 0.8284 0.6716 1.5 1.5 1.5 h 11 c 0.8284 0 1.5 -0.6716 1.5 -1.5 c 0 -0.8284 -0.6716 -1.5 -1.5 -1.5 h -11 z" fill="#940000"/><path fill-rule="evenodd" clip-rule="evenodd" d="M 2.5 4.5 c -0.8284 0 -1.5 0.6716 -1.5 1.5 c 0 0.8284 0.6716 1.5 1.5 1.5 h 11 c 0.8284 0 1.5 -0.6716 1.5 -1.5 c 0 -0.8284 -0.6716 -1.5 -1.5 -1.5 h -11 z" fill="#940000"/><path fill-rule="evenodd" clip-rule="evenodd" d="M 2.5 8.5 c -0.8284 0 -1.5 0.6716 -1.5 1.5 c 0 0.8284 0.6716 1.5 1.5 1.5 h 11 c 0.8284 0 1.5 -0.6716 1.5 -1.5 c 0 -0.8284 -0.6716 -1.5 -1.5 -1.5 h -11 z" fill="#940000"/><path d="M 2.5 12.5 c -0.8284 0 -1.5 0.6716 -1.5 1.5 c 0 0.8284 0.6716 1.5 1.5 1.5 h 11 c 0.8284 0 1.5 -0.6716 1.5 -1.5 c 0 -0.8284 -0.6716 -1.5 -1.5 -1.5 h -11 z" fill="#940000"/></svg>';
                else if (item.priority.includes('üî¥')) priority = '<svg width="12" height="12" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M 2.5 0.5 c -0.8284 0 -1.5 0.6716 -1.5 1.5 c 0 0.8284 0.6716 1.5 1.5 1.5 h 11 c 0.8284 0 1.5 -0.6716 1.5 -1.5 c 0 -0.8284 -0.6716 -1.5 -1.5 -1.5 h -11 z m 11 1 h -11 c -0.2761 0 -0.5 0.2239 -0.5 0.5 c 0 0.2761 0.2239 0.5 0.5 0.5 h 11 c 0.2761 0 0.5 -0.2239 0.5 -0.5 c 0 -0.2761 -0.2239 -0.5 -0.5 -0.5 z" fill="#B2B8BF"/><path fill-rule="evenodd" clip-rule="evenodd" d="M 2.5 4.5 c -0.8284 0 -1.5 0.6716 -1.5 1.5 c 0 0.8284 0.6716 1.5 1.5 1.5 h 11 c 0.8284 0 1.5 -0.6716 1.5 -1.5 c 0 -0.8284 -0.6716 -1.5 -1.5 -1.5 h -11 z" fill="#FF0000"/><path fill-rule="evenodd" clip-rule="evenodd" d="M 2.5 8.5 c -0.8284 0 -1.5 0.6716 -1.5 1.5 c 0 0.8284 0.6716 1.5 1.5 1.5 h 11 c 0.8284 0 1.5 -0.6716 1.5 -1.5 c 0 -0.8284 -0.6716 -1.5 -1.5 -1.5 h -11 z" fill="#FF0000"/><path d="M 2.5 12.5 c -0.8284 0 -1.5 0.6716 -1.5 1.5 c 0 0.8284 0.6716 1.5 1.5 1.5 h 11 c 0.8284 0 1.5 -0.6716 1.5 -1.5 c 0 -0.8284 -0.6716 -1.5 -1.5 -1.5 h -11 z" fill="#FF0000"/></svg>';
                else if (item.priority.includes('üü°')) priority = '<svg width="12" height="12" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M 2.5 0.5 c -0.8284 0 -1.5 0.6716 -1.5 1.5 c 0 0.8284 0.6716 1.5 1.5 1.5 h 11 c 0.8284 0 1.5 -0.6716 1.5 -1.5 c 0 -0.8284 -0.6716 -1.5 -1.5 -1.5 h -11 z m 11 1 h -11 c -0.2761 0 -0.5 0.2239 -0.5 0.5 c 0 0.2761 0.2239 0.5 0.5 0.5 h 11 c 0.2761 0 0.5 -0.2239 0.5 -0.5 c 0 -0.2761 -0.2239 -0.5 -0.5 -0.5 z" fill="#B2B8BF"/><path fill-rule="evenodd" clip-rule="evenodd" d="M 2.5 4.5 c -0.8284 0 -1.5 0.6716 -1.5 1.5 c 0 0.8284 0.6716 1.5 1.5 1.5 h 11 c 0.8284 0 1.5 -0.6716 1.5 -1.5 c 0 -0.8284 -0.6716 -1.5 -1.5 -1.5 h -11 z m 11 1 h -11 c -0.2761 0 -0.5 0.2239 -0.5 0.5 c 0 0.2761 0.2239 0.5 0.5 0.5 h 11 c 0.2761 0 0.5 -0.2239 0.5 -0.5 c 0 -0.2761 -0.2239 -0.5 -0.5 -0.5 z" fill="#B2B8BF"/><path fill-rule="evenodd" clip-rule="evenodd" d="M 2.5 8.5 c -0.8284 0 -1.5 0.6716 -1.5 1.5 c 0 0.8284 0.6716 1.5 1.5 1.5 h 11 c 0.8284 0 1.5 -0.6716 1.5 -1.5 c 0 -0.8284 -0.6716 -1.5 -1.5 -1.5 h -11 z" fill="#FFFF00"/><path d="M 2.5 12.5 c -0.8284 0 -1.5 0.6716 -1.5 1.5 c 0 0.8284 0.6716 1.5 1.5 1.5 h 11 c 0.8284 0 1.5 -0.6716 1.5 -1.5 c 0 -0.8284 -0.6716 -1.5 -1.5 -1.5 h -11 z" fill="#FFFF00"/></svg>';
                else if (item.priority.includes('üü¢')) priority = '<svg width="12" height="12" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M 2.5 0.5 c -0.8284 0 -1.5 0.6716 -1.5 1.5 c 0 0.8284 0.6716 1.5 1.5 1.5 h 11 c 0.8284 0 1.5 -0.6716 1.5 -1.5 c 0 -0.8284 -0.6716 -1.5 -1.5 -1.5 h -11 z m 11 1 h -11 c -0.2761 0 -0.5 0.2239 -0.5 0.5 c 0 0.2761 0.2239 0.5 0.5 0.5 h 11 c 0.2761 0 0.5 -0.2239 0.5 -0.5 c 0 -0.2761 -0.2239 -0.5 -0.5 -0.5 z" fill="#B2B8BF"/><path fill-rule="evenodd" clip-rule="evenodd" d="M 2.5 4.5 c -0.8284 0 -1.5 0.6716 -1.5 1.5 c 0 0.8284 0.6716 1.5 1.5 1.5 h 11 c 0.8284 0 1.5 -0.6716 1.5 -1.5 c 0 -0.8284 -0.6716 -1.5 -1.5 -1.5 h -11 z m 11 1 h -11 c -0.2761 0 -0.5 0.2239 -0.5 0.5 c 0 0.2761 0.2239 0.5 0.5 0.5 h 11 c 0.2761 0 0.5 -0.2239 0.5 -0.5 c 0 -0.2761 -0.2239 -0.5 -0.5 -0.5 z" fill="#B2B8BF"/><path fill-rule="evenodd" clip-rule="evenodd" d="M 2.5 8.5 c -0.8284 0 -1.5 0.6716 -1.5 1.5 c 0 0.8284 0.6716 1.5 1.5 1.5 h 11 c 0.8284 0 1.5 -0.6716 1.5 -1.5 c 0 -0.8284 -0.6716 -1.5 -1.5 -1.5 h -11 z m 11 1 h -11 c -0.2761 0 -0.5 0.2239 -0.5 0.5 c 0 0.2761 0.2239 0.5 0.5 0.5 h 11 c 0.2761 0 0.5 -0.2239 0.5 -0.5 c 0 -0.2761 -0.2239 -0.5 -0.5 -0.5 z" fill="#B2B8BF"/><path d="M 2.5 12.5 c -0.8284 0 -1.5 0.6716 -1.5 1.5 c 0 0.8284 0.6716 1.5 1.5 1.5 h 11 c 0.8284 0 1.5 -0.6716 1.5 -1.5 c 0 -0.8284 -0.6716 -1.5 -1.5 -1.5 h -11 z" fill="#00FF00"/></svg>';
                
                row.innerHTML = `
                    <td style="text-align:left">${priority} ${item.rule}</td>
                    <td style="text-align:right">${formatNumber(item.count)}</td>
                `;
                tbody.appendChild(row);
            });
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∏—Ç–æ–≥–æ–≤—É—é —Å—Ç—Ä–æ–∫—É
            const totalRow = document.createElement('tr');
            totalRow.style.fontWeight = 'bold';
            const totalAlerts = alerts.reduce((sum, item) => sum + item.count, 0);
            totalRow.innerHTML = `
                <td style="text-align:left">–ò—Ç–æ–≥–æ</td>
                <td style="text-align:right">${formatNumber(totalAlerts)}</td>
            `;
            tbody.appendChild(totalRow);
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.onload = initializeReport;
    </script>
</body>
</html>